<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Í≤åÏãúÎ¨º ÏûêÎèôÌôî ÎèÑÍµ¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 40px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            color: #333;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 1.1em;
        }

        .tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 2px solid #e0e0e0;
        }

        .tab {
            padding: 15px 30px;
            background: none;
            border: none;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 1.1em;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }

        .post-list {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            max-height: 400px;
            overflow-y: auto;
        }

        .post-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .post-content {
            flex: 1;
            margin-right: 15px;
        }

        .post-content h4 {
            color: #333;
            margin-bottom: 5px;
        }

        .post-content p {
            color: #666;
            font-size: 14px;
            line-height: 1.4;
        }

        .post-actions {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .btn-large {
            width: 100%;
            padding: 18px;
            font-size: 1.2em;
        }

        /* Î™®Îã¨ Ïä§ÌÉÄÏùº */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 30px;
            border-bottom: 2px solid #e0e0e0;
        }

        .modal-header h3 {
            margin: 0;
            color: #333;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
            padding: 5px;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            background: #f0f0f0;
            color: #333;
        }

        .modal-body {
            padding: 30px;
        }

        .modal-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
        }

        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .setting-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
        }

        .setting-card h3 {
            color: #333;
            margin-bottom: 15px;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .checkbox-group input[type="checkbox"] {
            width: auto;
            margin: 0;
        }

        .status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            display: none;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #ffffff;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .logs {
            margin-top: 30px;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.4;
        }

        .logs h3 {
            margin-bottom: 15px;
            color: #333;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .log-entry {
            margin-bottom: 5px;
            word-wrap: break-word;
        }

        .required {
            color: #e74c3c;
        }

        .help-text {
            margin-top: 10px;
            padding: 10px;
            background: #e3f2fd;
            border-radius: 8px;
            font-size: 14px;
            color: #1565c0;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            width: 0%;
            transition: width 0.3s ease;
        }

        .automation-controls {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .automation-controls .btn {
            flex: 1;
        }

        /* üì∏üé¨ ÎØ∏ÎîîÏñ¥ ÏóÖÎ°úÎìú Ïä§ÌÉÄÏùº */
        .media-section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border: 2px dashed #667eea;
        }

        .media-upload-group {
            margin-bottom: 20px;
        }

        .media-upload-btn {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            border: none;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .media-upload-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }

        .selected-media {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .media-item {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            background: white;
            border: 2px solid #e9ecef;
        }

        .media-item img {
            width: 120px;
            height: 80px;
            object-fit: cover;
            display: block;
        }

        .media-item .remove-btn {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ff4757;
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .media-item .remove-btn:hover {
            background: #ff3742;
            transform: scale(1.1);
        }

        .video-results {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 15px;
            border-radius: 8px;
            background: white;
            border: 1px solid #e9ecef;
        }

        .video-result-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-bottom: 1px solid #e9ecef;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .video-result-item:hover {
            background-color: #f8f9fa;
        }

        .video-result-item:last-child {
            border-bottom: none;
        }

        .video-result-item img {
            width: 80px;
            height: 60px;
            object-fit: cover;
            border-radius: 4px;
            margin-right: 12px;
        }

        .video-result-info {
            flex: 1;
        }

        .video-result-title {
            font-weight: bold;
            margin-bottom: 4px;
            color: #333;
            font-size: 14px;
        }

        .video-result-channel {
            font-size: 12px;
            color: #666;
        }

        .video-item {
            display: flex;
            align-items: center;
            background: white;
            border-radius: 8px;
            padding: 10px;
            border: 2px solid #e9ecef;
        }

        .video-item img {
            width: 80px;
            height: 60px;
            object-fit: cover;
            border-radius: 4px;
            margin-right: 10px;
        }

        .video-item-info {
            flex: 1;
            font-size: 14px;
        }

        .video-item-title {
            font-weight: bold;
            margin-bottom: 2px;
        }

        .video-item-channel {
            color: #666;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé¨ YouTube ÏûêÎèôÌôî Pro</h1>
            <p>Ïó¨Îü¨ Í≤åÏãúÎ¨ºÏùÑ ÏàúÏ∞®Ï†ÅÏúºÎ°ú ÏûêÎèô ÏûëÏÑ±Ìï¥ÎìúÎ¶ΩÎãàÎã§</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('accounts', event)">üë• Í≥ÑÏ†ï Í¥ÄÎ¶¨</button>
            <button class="tab" onclick="switchTab('posts', event)">üìù Í≤åÏãúÎ¨º</button>
            <button class="tab" onclick="switchTab('settings', event)">‚öôÔ∏è ÏÑ§Ï†ï</button>
            <button class="tab" onclick="switchTab('automation', event)">üöÄ Ïã§Ìñâ</button>
        </div>

        <!-- Í≥ÑÏ†ï Í¥ÄÎ¶¨ ÌÉ≠ -->
        <div id="accounts" class="tab-content active">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3 style="margin: 0;">üë• Í≥ÑÏ†ï Í¥ÄÎ¶¨</h3>
                <div id="accountCount" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 8px 16px; border-radius: 20px; font-size: 14px; font-weight: bold; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                    üíæ Ï†ÄÏû•Îêú Í≥ÑÏ†ï: 0Í∞ú
                </div>
            </div>

            <!-- Í≥ÑÏ†ï Ï∂îÍ∞Ä Ìèº -->
            <div style="background: #f8f9fa; border-radius: 10px; padding: 20px; margin-bottom: 20px;">
                <h4 style="margin-bottom: 15px;">‚ûï ÏÉà Í≥ÑÏ†ï Ï∂îÍ∞Ä</h4>
                <form id="accountForm">
                    <div class="form-group">
                        <label for="accountName">Í≥ÑÏ†ïÎ™Ö (Î≥ÑÏπ≠) <span class="required">*</span></label>
                        <input type="text" id="accountName" placeholder="Ïòà: Î©îÏù∏ Í≥ÑÏ†ï, ÏÑúÎ∏å Í≥ÑÏ†ï" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="accountUsername">YouTube ÏïÑÏù¥Îîî <span class="required">*</span></label>
                        <input type="text" id="accountUsername" placeholder="YouTube Í≥ÑÏ†ï ÏïÑÏù¥Îîî" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="accountPassword">ÎπÑÎ∞ÄÎ≤àÌò∏ <span class="required">*</span></label>
                        <input type="password" id="accountPassword" placeholder="YouTube Í≥ÑÏ†ï ÎπÑÎ∞ÄÎ≤àÌò∏" required>
                        <div class="help-text">
                            üí° <strong>2Ï∞® Ïù∏Ï¶ù ÏÇ¨Ïö© Ïãú:</strong> <a href="https://myaccount.google.com/apppasswords" target="_blank">Google Ïï± ÎπÑÎ∞ÄÎ≤àÌò∏</a> ÏÇ¨Ïö© Í∂åÏû•
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="accountDescription">ÏÑ§Î™Ö (ÏÑ†ÌÉùÏÇ¨Ìï≠)</label>
                        <textarea id="accountDescription" placeholder="Í≥ÑÏ†ïÏóê ÎåÄÌïú ÏÑ§Î™ÖÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî..." rows="3"></textarea>
                    </div>
                    
                    <div style="display: flex; gap: 10px;">
                        <button type="button" class="btn btn-primary" onclick="addAccount()">
                            ‚ûï Í≥ÑÏ†ï Ï∂îÍ∞Ä
                        </button>
                        <button id="cancelEditPostBtn" type="button" style="display:none;" onclick="cancelEditPost()">
                            ‚ùå Ï∑®ÏÜå
                        </button>
                    </div>
                </form>
            </div>

            <!-- Í≥ÑÏ†ï Î™©Î°ù -->
            <div class="post-list" id="accountList">
                <p style="text-align: center; color: #666; font-style: italic;">
                    ÏïÑÏßÅ Îì±Î°ùÎêú Í≥ÑÏ†ïÏù¥ ÏóÜÏäµÎãàÎã§.<br>
                    ÏúÑÏóêÏÑú Í≥ÑÏ†ïÏùÑ Ï∂îÍ∞ÄÌï¥Î≥¥ÏÑ∏Ïöî!
                </p>
            </div>
        </div>

        <!-- Í≤åÏãúÎ¨º Í¥ÄÎ¶¨ ÌÉ≠ -->
        <div id="posts" class="tab-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3 style="margin: 0;">üìù Í≤åÏãúÎ¨º Í¥ÄÎ¶¨</h3>
                <div id="postCount" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 8px 16px; border-radius: 20px; font-size: 14px; font-weight: bold; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                    üíæ Ï†ÄÏû•Îêú Í≤åÏãúÎ¨º: 0Í∞ú
                </div>
            </div>
            
            <div class="form-group">
                <label for="postAccount">ÏÇ¨Ïö©Ìï† Í≥ÑÏ†ï ÏÑ†ÌÉù <span class="required">*</span></label>
                <select id="postAccount" required>
                    <option value="">Í≥ÑÏ†ïÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
                </select>
            </div>

            <div class="form-group">
                <label for="newPostContent">ÏÉà Í≤åÏãúÎ¨º ÎÇ¥Ïö© <span class="required">*</span></label>
                <textarea id="newPostContent" placeholder="Í≤åÏãúÌï† ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî..."></textarea>
            </div>

            <!-- üì∏üé¨ ÎØ∏ÎîîÏñ¥ Ï∂îÍ∞Ä ÏÑπÏÖò -->
            <div class="media-section">
                <h4 style="margin-bottom: 15px;">üì∏ ÎØ∏ÎîîÏñ¥ Ï∂îÍ∞Ä</h4>
                
                <!-- Ïù¥ÎØ∏ÏßÄ ÏóÖÎ°úÎìú -->
                <div class="media-upload-group">
                    <label class="media-upload-btn" for="imageUpload">
                        üñºÔ∏è Ïù¥ÎØ∏ÏßÄ ÏÑ†ÌÉù
                        <input type="file" id="imageUpload" accept="image/*" multiple style="display: none;" onchange="handleImageUpload(event)">
                    </label>
                    <div id="selectedImages" class="selected-media"></div>
                </div>

                <!-- ÎèôÏòÅÏÉÅ Í≤ÄÏÉâ -->
                <div class="media-upload-group">
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <input type="text" id="videoSearch" placeholder="YouTubeÏóêÏÑú ÎèôÏòÅÏÉÅ Í≤ÄÏÉâ..." style="flex: 1;" onkeypress="if(event.key==='Enter') searchVideos()">
                        <button type="button" class="btn btn-secondary" onclick="searchVideos()">
                            üîç Í≤ÄÏÉâ
                        </button>
                    </div>
                    <div id="videoResults" class="video-results"></div>
                    <div id="selectedVideos" class="selected-media"></div>
                </div>
            </div>
            
            <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                <button id="addPostBtn" type="button" onclick="addPost()">
                    ‚ûï Í≤åÏãúÎ¨º Ï∂îÍ∞Ä
                </button>
                <button type="button" class="btn btn-secondary" onclick="clearAllPosts()">
                    üóëÔ∏è Ï†ÑÏ≤¥ ÏÇ≠Ï†ú
                </button>
                <button type="button" class="btn btn-secondary" onclick="exportPosts()">
                    üíæ ÎÇ¥Î≥¥ÎÇ¥Í∏∞
                </button>
                <button type="button" class="btn btn-secondary" onclick="importPosts()">
                    üìÅ Í∞ÄÏ†∏Ïò§Í∏∞
                </button>
            </div>

            <div class="post-list" id="postList">
                <p style="text-align: center; color: #666; font-style: italic;">
                    ÏïÑÏßÅ Îì±Î°ùÎêú Í≤åÏãúÎ¨ºÏù¥ ÏóÜÏäµÎãàÎã§.<br>
                    ÏúÑÏóêÏÑú Í≤åÏãúÎ¨ºÏùÑ Ï∂îÍ∞ÄÌï¥Î≥¥ÏÑ∏Ïöî!
                </p>
            </div>
        </div>

        <!-- ÏûêÎèôÌôî ÏÑ§Ï†ï ÌÉ≠ -->
        <div id="settings" class="tab-content">
            <div class="settings-grid">
                <div class="setting-card">
                    <h3>üñ•Ô∏è Î∏åÎùºÏö∞Ï†Ä ÏÑ§Ï†ï</h3>
                    <div class="checkbox-group">
                        <input type="checkbox" id="showBrowser" checked>
                        <label for="showBrowser">Î∏åÎùºÏö∞Ï†Ä ÌôîÎ©¥ ÌëúÏãú</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="maximizeWindow" checked>
                        <label for="maximizeWindow">Î∏åÎùºÏö∞Ï†Ä ÏµúÎåÄÌôî</label>
                    </div>
                    <div class="form-group">
                        <label for="browserSpeed">Î∏åÎùºÏö∞Ï†Ä ÏÜçÎèÑ</label>
                        <select id="browserSpeed">
                            <option value="fast">Îπ†Î¶Ñ (Í∂åÏû•)</option>
                            <option value="normal">Î≥¥ÌÜµ</option>
                            <option value="slow">ÎäêÎ¶º (ÏïàÏ†ïÏÑ± Ïö∞ÏÑ†)</option>
                        </select>
                    </div>
                </div>

                <div class="setting-card">
                    <h3>‚è±Ô∏è ÎåÄÍ∏∞ ÏãúÍ∞Ñ ÏÑ§Ï†ï</h3>
                    <div class="form-group">
                        <label for="postDelay">Í≤åÏãúÎ¨º Í∞Ñ ÎåÄÍ∏∞ ÏãúÍ∞Ñ (Ï¥à)</label>
                        <input type="number" id="postDelay" value="5" min="1" max="60">
                    </div>
                    <div class="form-group">
                        <label for="manualPostWait">ÏàòÎèô Í≤åÏãú ÎåÄÍ∏∞ ÏãúÍ∞Ñ (Ï¥à)</label>
                        <input type="number" id="manualPostWait" value="20" min="10" max="120">
                    </div>
                </div>

                <div class="setting-card">
                    <h3>üîÑ ÏûêÎèôÌôî ÏòµÏÖò</h3>
                    <div class="checkbox-group">
                        <input type="checkbox" id="autoRetry" checked>
                        <label for="autoRetry">Ïã§Ìå® Ïãú ÏûêÎèô Ïû¨ÏãúÎèÑ</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="skipOnError">
                        <label for="skipOnError">Ïò§Î•ò Ïãú Îã§Ïùå Í≤åÏãúÎ¨ºÎ°ú Í±¥ÎÑàÎõ∞Í∏∞</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="closeOnComplete" checked>
                        <label for="closeOnComplete">ÏôÑÎ£å ÌõÑ Î∏åÎùºÏö∞Ï†Ä ÏûêÎèô Ï¢ÖÎ£å</label>
                    </div>
                </div>

                <div class="setting-card">
                    <h3>üìä Î°úÍ∑∏ ÏÑ§Ï†ï</h3>
                    <div class="checkbox-group">
                        <input type="checkbox" id="detailedLogs" checked>
                        <label for="detailedLogs">ÏÉÅÏÑ∏ Î°úÍ∑∏ ÌëúÏãú</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="saveLogsToFile">
                        <label for="saveLogsToFile">Î°úÍ∑∏ ÌååÏùºÎ°ú Ï†ÄÏû•</label>
                    </div>
                </div>
            </div>

            <button type="button" class="btn btn-primary btn-large" onclick="saveSettings()">
                üíæ ÏÑ§Ï†ï Ï†ÄÏû•
            </button>
        </div>

        <!-- ÏûêÎèôÌôî Ïã§Ìñâ ÌÉ≠ -->
        <div id="automation" class="tab-content">
            <div class="status" id="automationStatus">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <p id="statusText">ÏûêÎèôÌôî Ï§ÄÎπÑ ÏôÑÎ£å</p>
            </div>

            <div class="automation-controls">
                <button type="button" class="btn btn-success btn-large" id="startAutomation" onclick="startAutomation()">
                    üöÄ ÏûêÎèôÌôî ÏãúÏûë
                </button>
                <button type="button" class="btn btn-danger btn-large" id="stopAutomation" onclick="stopAutomation()" disabled>
                    ‚èπÔ∏è ÏûêÎèôÌôî Ï§ëÏßÄ
                </button>
                <button type="button" class="btn btn-secondary btn-large" onclick="resetAutomation()">
                    üîÑ Ï¥àÍ∏∞Ìôî
                </button>
            </div>

            <div class="logs" id="automationLogs">
                <h3>üìã ÏûêÎèôÌôî Î°úÍ∑∏</h3>
                <div id="logEntries">
                    <div class="log-entry">ÏûêÎèôÌôî ÏãúÏûëÏùÑ Í∏∞Îã§Î¶¨Îäî Ï§ë...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Í≤åÏãúÎ¨º ÏàòÏ†ï Î™®Îã¨ -->
    <div id="editPostModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚úèÔ∏è Í≤åÏãúÎ¨º ÏàòÏ†ï</h3>
                <button class="close-btn" onclick="closeEditPostModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="editPostForm">
                    <div class="form-group">
                        <label for="editPostAccount">ÏÇ¨Ïö©Ìï† Í≥ÑÏ†ï ÏÑ†ÌÉù <span class="required">*</span></label>
                        <select id="editPostAccount" required>
                            <option value="">Í≥ÑÏ†ïÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="editPostContent">Í≤åÏãúÎ¨º ÎÇ¥Ïö© <span class="required">*</span></label>
                        <textarea id="editPostContent" placeholder="Í≤åÏãúÌï† ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî..." rows="6" required></textarea>
                    </div>

                    <!-- Í∏∞Ï°¥ Ïù¥ÎØ∏ÏßÄ -->
                    <div class="form-group" id="editImagesSection">
                        <label>üì∏ Í∏∞Ï°¥ Ïù¥ÎØ∏ÏßÄ</label>
                        <div id="editExistingImages" class="selected-media"></div>
                    </div>

                    <!-- ÏÉà Ïù¥ÎØ∏ÏßÄ Ï∂îÍ∞Ä -->
                    <div class="form-group">
                        <label class="media-upload-btn" for="editImageUpload">
                            üñºÔ∏è ÏÉà Ïù¥ÎØ∏ÏßÄ Ï∂îÍ∞Ä
                            <input type="file" id="editImageUpload" accept="image/*" multiple style="display: none;" onchange="handleEditImageUpload(event)">
                        </label>
                        <div id="editNewImages" class="selected-media"></div>
                    </div>

                    <!-- Í∏∞Ï°¥ ÎèôÏòÅÏÉÅ -->
                    <div class="form-group" id="editVideosSection">
                        <label>üé¨ Í∏∞Ï°¥ ÎèôÏòÅÏÉÅ</label>
                        <div id="editExistingVideos" class="selected-media"></div>
                    </div>

                    <!-- ÏÉà ÎèôÏòÅÏÉÅ Í≤ÄÏÉâ -->
                    <div class="form-group">
                        <label>üé¨ ÏÉà ÎèôÏòÅÏÉÅ Ï∂îÍ∞Ä</label>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <input type="text" id="editVideoSearch" placeholder="YouTubeÏóêÏÑú ÎèôÏòÅÏÉÅ Í≤ÄÏÉâ..." style="flex: 1;" onkeypress="if(event.key==='Enter') searchEditVideos()">
                            <button type="button" class="btn btn-secondary" onclick="searchEditVideos()">
                                üîç Í≤ÄÏÉâ
                            </button>
                        </div>
                        <div id="editVideoResults" class="video-results"></div>
                        <div id="editNewVideos" class="selected-media"></div>
                    </div>

                    <div class="modal-actions">
                        <button type="button" class="btn btn-primary" onclick="saveEditedPost()">
                            üíæ ÏàòÏ†ï ÏôÑÎ£å
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="closeEditPostModal()">
                            ‚ùå Ï∑®ÏÜå
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
       
        // Ï†ÑÏó≠ Î≥ÄÏàò
        let posts = [];
        let accounts = [];
        let currentPostIndex = 0;
        let isAutomationRunning = false;
        let automationSocket = null;
        let selectedImages = [];
        let selectedVideos = [];
        let editingAccountId = null;
        let editingPostId = null;
        let editNewImages = [];
        let editNewVideos = [];

        // ÌÉ≠ Ï†ÑÌôò
        function switchTab(tabName, event) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            if (event) event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }
        window.switchTab = switchTab;

        // üì∏üé¨ Ïù¥ÎØ∏ÏßÄ ÏóÖÎ°úÎìú Ï≤òÎ¶¨ (multer + multipart/form-data)
        async function handleImageUpload(event) {
            const files = Array.from(event.target.files);
            for (const file of files) {
                if (file.type.startsWith('image/')) {
                    const formData = new FormData();
                    formData.append('image', file);
                    try {
                        const res = await fetch('/api/upload-image', {
                            method: 'POST',
                            body: formData
                        });
                        const data = await res.json();
                        if (data.success && data.url) {
                            selectedImages.push({ url: data.url, name: file.name, type: 'image' });
                            updateSelectedImages();
                        } else {
                            alert('Ïù¥ÎØ∏ÏßÄ ÏóÖÎ°úÎìú Ïã§Ìå®: ' + (data.error || 'ÏÑúÎ≤Ñ Ïò§Î•ò'));
                        }
                    } catch (err) {
                        alert('Ïù¥ÎØ∏ÏßÄ ÏóÖÎ°úÎìú Ï§ë Ïò§Î•ò Î∞úÏÉù');
                    }
                }
            }
        }

        // üì∏ ÏÑ†ÌÉùÎêú Ïù¥ÎØ∏ÏßÄ ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
        function updateSelectedImages() {
            const container = document.getElementById('selectedImages');
            if (selectedImages.length === 0) {
                container.innerHTML = '';
                return;
            }
            container.innerHTML = selectedImages.map(img => `
                <div class="media-item">
                    <img src="${img.url}" alt="${img.name}">
                    <button class="remove-btn" onclick="removeImage('${img.url}')">√ó</button>
                </div>
            `).join('');
        }

        // üì∏ Ïù¥ÎØ∏ÏßÄ Ï†úÍ±∞
        function removeImage(imageUrl) {
            selectedImages = selectedImages.filter(img => img.url !== imageUrl);
            updateSelectedImages();
        }

        // üé¨ YouTube ÎèôÏòÅÏÉÅ Í≤ÄÏÉâ (Ïï±Ïö© - ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ ÏßÅÏ†ë Ï≤òÎ¶¨)
        async function searchVideos() {
            const query = document.getElementById('videoSearch').value.trim();
            if (!query) {
                alert('Í≤ÄÏÉâÏñ¥Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            const resultsContainer = document.getElementById('videoResults');
            resultsContainer.innerHTML = '<div style="text-align: center; padding: 20px;">üîç Í≤ÄÏÉâ Ï§ë...</div>';
            try {
                // ÏÑúÎ≤Ñ APIÎ°ú Ïã§Ï†ú Í≤ÄÏÉâ
                const res = await fetch(`/api/search-videos?query=${encodeURIComponent(query)}`);
                const data = await res.json();
                if (data.success && Array.isArray(data.videos)) {
                    displayVideoResults(data.videos);
                } else {
                    resultsContainer.innerHTML = '<div style="text-align: center; padding: 20px; color: #ff4757;">‚ùå Í≤ÄÏÉâ Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§.</div>';
                }
            } catch (error) {
                resultsContainer.innerHTML = '<div style="text-align: center; padding: 20px; color: #ff4757;">‚ùå Í≤ÄÏÉâ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.</div>';
                console.error('Video search error:', error);
            }
        }

        // üé¨ ÎèôÏòÅÏÉÅ Í≤ÄÏÉâ Í≤∞Í≥º ÌëúÏãú
        function displayVideoResults(videos) {
            const container = document.getElementById('videoResults');
            
            if (videos.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">Í≤ÄÏÉâ Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§.</div>';
                return;
            }
            
            container.innerHTML = videos.map(video => `
                <div class="video-result-item" onclick="selectVideo('${video.id}', '${video.title}', '${video.channel}', '${video.thumbnail}')">
                    <img src="${video.thumbnail}" alt="${video.title}">
                    <div class="video-result-info">
                        <div class="video-result-title">${video.title}</div>
                        <div class="video-result-channel">${video.channel}</div>
                    </div>
                </div>
            `).join('');
        }

        // üé¨ ÎèôÏòÅÏÉÅ ÏÑ†ÌÉù
        function selectVideo(videoId, title, channel, thumbnail) {
            const videoData = {
                id: videoId,
                title: title,
                channel: channel,
                thumbnail: thumbnail,
                url: `https://www.youtube.com/watch?v=${videoId}`
            };
            
            // Ï§ëÎ≥µ ÏÑ†ÌÉù Î∞©ÏßÄ
            if (!selectedVideos.find(v => v.id === videoId)) {
                selectedVideos.push(videoData);
                updateSelectedVideos();
                
                // Í≤ÄÏÉâ Í≤∞Í≥º Ïà®Í∏∞Í∏∞
                document.getElementById('videoResults').innerHTML = '';
                document.getElementById('videoSearch').value = '';
            }
        }

        // üé¨ ÏÑ†ÌÉùÎêú ÎèôÏòÅÏÉÅ ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
        function updateSelectedVideos() {
            const container = document.getElementById('selectedVideos');
            
            if (selectedVideos.length === 0) {
                container.innerHTML = '';
                return;
            }
            
            container.innerHTML = selectedVideos.map(video => `
                <div class="video-item">
                    <img src="${video.thumbnail}" alt="${video.title}">
                    <div class="video-item-info">
                        <div class="video-item-title">${video.title}</div>
                        <div class="video-item-channel">${video.channel}</div>
                    </div>
                    <button class="remove-btn" onclick="removeVideo('${video.id}')">√ó</button>
                </div>
            `).join('');
        }

        // üé¨ ÎèôÏòÅÏÉÅ Ï†úÍ±∞
        function removeVideo(videoId) {
            selectedVideos = selectedVideos.filter(video => video.id !== videoId);
            updateSelectedVideos();
        }

        // Í≤åÏãúÎ¨º Ï∂îÍ∞Ä (Ïù¥ÎØ∏ÏßÄÎäî urlÎßå Ìè¨Ìï®)
        async function addPost() {
            const content = document.getElementById('newPostContent').value.trim();
            const accountId = document.getElementById('postAccount').value;
            if (!content) {
                alert('Í≤åÏãúÎ¨º ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî.');
                return;
            }
            if (!accountId) {
                alert('Í≥ÑÏ†ïÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî.');
                return;
            }
            const account = accounts.find(acc => acc.id === accountId);
            const images = selectedImages.map(img => ({ url: img.url, name: img.name, type: 'image' }));
            const videos = [...selectedVideos];
            const postData = {
                content,
                accountId,
                username: account ? account.username : '',
                password: account ? account.password : '',
                images,
                videos,
                status: 'pending',
                createdAt: new Date().toISOString()
            };
            const res = await fetch('/api/posts', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(postData)
            });
            const result = await res.json();
            if (result.success) {
                alert('Í≤åÏãúÎ¨ºÏù¥ Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§.');
                await loadAllAndUpdatePosts();
                document.getElementById('newPostContent').value = '';
                document.getElementById('postAccount').selectedIndex = 0;
                selectedImages = [];
                selectedVideos = [];
                updateSelectedImages();
                updateSelectedVideos();
            } else {
                alert('Í≤åÏãúÎ¨º Ï∂îÍ∞Ä Ïã§Ìå®');
            }
        }

        // Í≤åÏãúÎ¨º Î™©Î°ù ÏóÖÎç∞Ïù¥Ìä∏ (üíæ Í∞úÏàò ÌëúÏãú Ìè¨Ìï®)
        function updatePostList() {
            const postList = document.getElementById('postList');
            const postCount = document.getElementById('postCount');
            
            // üíæ Í≤åÏãúÎ¨º Í∞úÏàò ÏóÖÎç∞Ïù¥Ìä∏
            const completedCount = posts.filter(p => p.status === 'completed').length;
            const failedCount = posts.filter(p => p.status === 'failed').length;
            const pendingCount = posts.filter(p => p.status === 'pending').length;
            
            postCount.innerHTML = `üíæ Ï†ÄÏû•Îêú Í≤åÏãúÎ¨º: ${posts.length}Í∞ú 
                ${completedCount > 0 ? `(‚úÖ${completedCount}` : ''}
                ${failedCount > 0 ? ` ‚ùå${failedCount}` : ''}
                ${pendingCount > 0 ? ` ‚è≥${pendingCount}` : ''}
                ${completedCount > 0 || failedCount > 0 || pendingCount > 0 ? ')' : ''}`;
            
            if (posts.length === 0) {
                postList.innerHTML = `
                    <p style="text-align: center; color: #666; font-style: italic;">
                        ÏïÑÏßÅ Îì±Î°ùÎêú Í≤åÏãúÎ¨ºÏù¥ ÏóÜÏäµÎãàÎã§.<br>
                        ÏúÑÏóêÏÑú Í≤åÏãúÎ¨ºÏùÑ Ï∂îÍ∞ÄÌï¥Î≥¥ÏÑ∏Ïöî!
                    </p>
                `;
                return;
            }
            
            postList.innerHTML = posts.map((post, index) => {
                const imageCount = post.images ? post.images.length : 0;
                const videoCount = post.videos ? post.videos.length : 0;
                const mediaInfo = [];
                
                if (imageCount > 0) mediaInfo.push(`üì∏ ${imageCount}Í∞ú`);
                if (videoCount > 0) mediaInfo.push(`üé¨ ${videoCount}Í∞ú`);
                
                return `
                <div class="post-item">
                    <div class="post-content">
                        <h4>Í≤åÏãúÎ¨º ${index + 1} ${mediaInfo.length > 0 ? `(${mediaInfo.join(', ')})` : ''}</h4>
                        <p>${post.content.substring(0, 100)}${post.content.length > 100 ? '...' : ''}</p>
                        <small>ÏÉÅÌÉú: ${getStatusText(post.status)}</small>
                        ${post.account ? `<div style="margin-top: 4px; color: #28a745; font-size: 12px;">üë§ Í≥ÑÏ†ï: ${post.account.name} (${post.account.username})</div>` : ''}
                        ${mediaInfo.length > 0 ? `<div style="margin-top: 8px; color: #667eea; font-size: 12px;">üìé ÎØ∏ÎîîÏñ¥: ${mediaInfo.join(', ')}</div>` : ''}
                    </div>
                    <div class="post-actions">
                        ${post.status === 'pending' || post.status === 'failed' ? 
                            `<button class="btn btn-secondary" onclick="editPost('${post.id}')">ÏàòÏ†ï</button>` : 
                            `<button class="btn btn-secondary" disabled title="ÏôÑÎ£å ÎòêÎäî Ï≤òÎ¶¨Ï§ëÏù∏ Í≤åÏãúÎ¨ºÏùÄ ÏàòÏ†ïÌï† Ïàò ÏóÜÏäµÎãàÎã§">ÏàòÏ†ï</button>`
                        }
                        <button class="btn btn-danger" onclick="deletePost('${post.id}')">ÏÇ≠Ï†ú</button>
                    </div>
                </div>
                `;
            }).join('');
        }

        // ÏÉÅÌÉú ÌÖçÏä§Ìä∏ Î≥ÄÌôò
        function getStatusText(status) {
            const statusMap = {
                'pending': 'ÎåÄÍ∏∞ Ï§ë',
                'processing': 'Ï≤òÎ¶¨ Ï§ë',
                'completed': 'ÏôÑÎ£å',
                'failed': 'Ïã§Ìå®'
            };
            return statusMap[status] || status;
        }

        // Í≤åÏãúÎ¨º ÏÇ≠Ï†ú (API Ïó∞Îèô)
        async function deletePost(postId) {
            if (!confirm('Ïù¥ Í≤åÏãúÎ¨ºÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) return;
            const res = await fetch(`/api/posts/${postId}`, { method: 'DELETE' });
            const result = await res.json();
            if (result.success) {
                alert('Í≤åÏãúÎ¨ºÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.');
                await loadAllAndUpdatePosts();
            } else {
                alert('Í≤åÏãúÎ¨º ÏÇ≠Ï†ú Ïã§Ìå®');
            }
        }

        // Í≤åÏãúÎ¨º ÏàòÏ†ï (üíæ Ï†ÄÏû• Í∏∞Îä• Ï∂îÍ∞Ä)
        function editPost(postId) {
            const post = posts.find(p => p.id === postId);
            if (!post) {
                alert('Í≤åÏãúÎ¨ºÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');
                return;
            }
            if (post.status === 'completed' || post.status === 'processing') {
                alert('ÏôÑÎ£åÎêòÏóàÍ±∞ÎÇò Ï≤òÎ¶¨Ï§ëÏù∏ Í≤åÏãúÎ¨ºÏùÄ ÏàòÏ†ïÌï† Ïàò ÏóÜÏäµÎãàÎã§.');
                return;
            }
            openEditPostModal(post);
        }

        // Í≤åÏãúÎ¨º ÏàòÏ†ï Î™®Îã¨ Ïó¥Í∏∞
        function openEditPostModal(post) {
            console.log(document.getElementById('editPostContent'))
            editingPostId = post.id; // ‚Üê Ïù¥ Ï§ÑÏù¥ Î∞òÎìúÏãú ÌïÑÏöî!
            // Í≥ÑÏ†ï ÎìúÎ°≠Îã§Ïö¥ ÏóÖÎç∞Ïù¥Ìä∏
            updateEditAccountDropdown();
            
            // Í∏∞Ï°¥ Îç∞Ïù¥ÌÑ∞ ÏÑ§Ï†ï
            document.getElementById('editPostContent').value = post.content;
            
            // Í≥ÑÏ†ï ÏÑ†ÌÉù
            if (post.account) {
                document.getElementById('editPostAccount').value = post.account.id;
            }
            
            // Í∏∞Ï°¥ Ïù¥ÎØ∏ÏßÄ ÌëúÏãú
            displayEditExistingImages(post.images || []);
            
            // Í∏∞Ï°¥ ÎèôÏòÅÏÉÅ ÌëúÏãú
            displayEditExistingVideos(post.videos || []);
            
            // ÏÉàÎ°ú Ï∂îÍ∞ÄÌï† ÎØ∏ÎîîÏñ¥ Ï¥àÍ∏∞Ìôî
            editNewImages = [];
            editNewVideos = [];
            updateEditNewImages();
            updateEditNewVideos();
            
            // Î™®Îã¨ ÌëúÏãú
            document.getElementById('editPostModal').style.display = 'flex';
        }

        // Í≤åÏãúÎ¨º ÏàòÏ†ï Î™®Îã¨ Îã´Í∏∞
        function closeEditPostModal() {
            document.getElementById('editPostModal').style.display = 'none';
            editingPostId = null;
            editNewImages = [];
            editNewVideos = [];
            
            // Ìèº Ï¥àÍ∏∞Ìôî
            document.getElementById('editPostForm').reset();
            document.getElementById('editExistingImages').innerHTML = '';
            document.getElementById('editExistingVideos').innerHTML = '';
            document.getElementById('editNewImages').innerHTML = '';
            document.getElementById('editNewVideos').innerHTML = '';
            document.getElementById('editVideoResults').innerHTML = '';
        }

        // ÏàòÏ†ïÏö© Í≥ÑÏ†ï ÎìúÎ°≠Îã§Ïö¥ ÏóÖÎç∞Ïù¥Ìä∏
        function updateEditAccountDropdown() {
            const editPostAccount = document.getElementById('editPostAccount');
            
            // Í∏∞Ï°¥ ÏòµÏÖò Ï†úÍ±∞ (Ï≤´ Î≤àÏß∏ ÏòµÏÖò Ï†úÏô∏)
            while (editPostAccount.children.length > 1) {
                editPostAccount.removeChild(editPostAccount.lastChild);
            }

            // Í≥ÑÏ†ï ÏòµÏÖò Ï∂îÍ∞Ä
            accounts.forEach(account => {
                const option = document.createElement('option');
                option.value = account.id;
                option.textContent = `${account.name} (${account.username})`;
                editPostAccount.appendChild(option);
            });

            // ‚ùå updateEditAccountDropdown();  // Ïù¥ Ï§ÑÏùÑ Î∞òÎìúÏãú ÏÇ≠Ï†ú!
        }

        // Í∏∞Ï°¥ Ïù¥ÎØ∏ÏßÄ ÌëúÏãú
        function displayEditExistingImages(images) {
            const container = document.getElementById('editExistingImages');
            
            if (images.length === 0) {
                container.innerHTML = '<p style="color: #666; font-style: italic;">Îì±Î°ùÎêú Ïù¥ÎØ∏ÏßÄÍ∞Ä ÏóÜÏäµÎãàÎã§.</p>';
                return;
            }
            
            container.innerHTML = images.map((img, index) => `
                <div class="media-item">
                    <img src="${img.data}" alt="${img.name}">
                    <div class="media-item-info">
                        <div class="media-item-title">${img.name}</div>
                    </div>
                    <button class="remove-btn" onclick="removeEditExistingImage(${index})" title="Ïù¥ÎØ∏ÏßÄ ÏÇ≠Ï†ú">√ó</button>
                </div>
            `).join('');
        }

        // Í∏∞Ï°¥ ÎèôÏòÅÏÉÅ ÌëúÏãú
        function displayEditExistingVideos(videos) {
            const container = document.getElementById('editExistingVideos');
            
            if (videos.length === 0) {
                container.innerHTML = '<p style="color: #666; font-style: italic;">Îì±Î°ùÎêú ÎèôÏòÅÏÉÅÏù¥ ÏóÜÏäµÎãàÎã§.</p>';
                return;
            }
            
            container.innerHTML = videos.map((video, index) => `
                <div class="video-item">
                    <img src="${video.thumbnail}" alt="${video.title}">
                    <div class="video-item-info">
                        <div class="video-item-title">${video.title}</div>
                        <div class="video-item-channel">${video.channel}</div>
                    </div>
                    <button class="remove-btn" onclick="removeEditExistingVideo(${index})" title="ÎèôÏòÅÏÉÅ ÏÇ≠Ï†ú">√ó</button>
                </div>
            `).join('');
        }

        // Í∏∞Ï°¥ Ïù¥ÎØ∏ÏßÄ ÏÇ≠Ï†ú
        function removeEditExistingImage(index) {
            const post = posts.find(p => p.id === editingPostId);
            if (post && post.images) {
                post.images.splice(index, 1);
                displayEditExistingImages(post.images);
            }
        }

        // Í∏∞Ï°¥ ÎèôÏòÅÏÉÅ ÏÇ≠Ï†ú
        function removeEditExistingVideo(index) {
            const post = posts.find(p => p.id === editingPostId);
            if (post && post.videos) {
                post.videos.splice(index, 1);
                displayEditExistingVideos(post.videos);
            }
        }

        // ÏàòÏ†ïÏö© ÏÉà Ïù¥ÎØ∏ÏßÄ ÏóÖÎ°úÎìú Ï≤òÎ¶¨
        function handleEditImageUpload(event) {
            const files = Array.from(event.target.files);
            
            files.forEach(file => {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const imageData = {
                            id: Date.now() + Math.random(),
                            name: file.name,
                            type: 'image',
                            data: e.target.result,
                            file: file
                        };
                        
                        editNewImages.push(imageData);
                        updateEditNewImages();
                    };
                    reader.readAsDataURL(file);
                }
            });
        }

        // ÏàòÏ†ïÏö© ÏÉà Ïù¥ÎØ∏ÏßÄ ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
        function updateEditNewImages() {
            const container = document.getElementById('editNewImages');
            
            if (editNewImages.length === 0) {
                container.innerHTML = '';
                return;
            }
            
            container.innerHTML = editNewImages.map(img => `
                <div class="media-item">
                    <img src="${img.data}" alt="${img.name}">
                    <div class="media-item-info">
                        <div class="media-item-title">${img.name}</div>
                    </div>
                    <button class="remove-btn" onclick="removeEditNewImage('${img.id}')">√ó</button>
                </div>
            `).join('');
        }

        // ÏàòÏ†ïÏö© ÏÉà Ïù¥ÎØ∏ÏßÄ Ï†úÍ±∞
        function removeEditNewImage(imageId) {
            editNewImages = editNewImages.filter(img => img.id !== imageId);
            updateEditNewImages();
        }

        // ÏàòÏ†ïÏö© ÎèôÏòÅÏÉÅ Í≤ÄÏÉâ
        async function searchEditVideos() {
            const query = document.getElementById('editVideoSearch').value.trim();
            if (!query) {
                alert('Í≤ÄÏÉâÏñ¥Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            const resultsContainer = document.getElementById('editVideoResults');
            resultsContainer.innerHTML = '<div style="text-align: center; padding: 20px;">üîç Í≤ÄÏÉâ Ï§ë...</div>';
            try {
                // ÏÑúÎ≤Ñ APIÎ°ú Ïã§Ï†ú Í≤ÄÏÉâ
                const res = await fetch(`/api/search-videos?query=${encodeURIComponent(query)}`);
                const data = await res.json();
                if (data.success && Array.isArray(data.videos)) {
                    displayEditVideoResults(data.videos);
                } else {
                    resultsContainer.innerHTML = '<div style="text-align: center; padding: 20px; color: #ff4757;">‚ùå Í≤ÄÏÉâ Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§.</div>';
                }
            } catch (error) {
                resultsContainer.innerHTML = '<div style="text-align: center; padding: 20px; color: #ff4757;">‚ùå Í≤ÄÏÉâ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.</div>';
                console.error('Video search error:', error);
            }
        }

        // ÏàòÏ†ïÏö© ÎèôÏòÅÏÉÅ Í≤ÄÏÉâ Í≤∞Í≥º ÌëúÏãú
        function displayEditVideoResults(videos) {
            const container = document.getElementById('editVideoResults');
            
            if (videos.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">Í≤ÄÏÉâ Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§.</div>';
                return;
            }
            
            container.innerHTML = videos.map(video => `
                <div class="video-result-item" onclick="selectEditVideo('${video.id}', '${video.title}', '${video.channel}', '${video.thumbnail}')">
                    <img src="${video.thumbnail}" alt="${video.title}">
                    <div class="video-result-info">
                        <div class="video-result-title">${video.title}</div>
                        <div class="video-result-channel">${video.channel}</div>
                    </div>
                </div>
            `).join('');
        }

        // ÏàòÏ†ïÏö© ÎèôÏòÅÏÉÅ ÏÑ†ÌÉù
        function selectEditVideo(videoId, title, channel, thumbnail) {
            const videoData = {
                id: videoId,
                title: title,
                channel: channel,
                thumbnail: thumbnail,
                url: `https://www.youtube.com/watch?v=${videoId}`
            };
            
            // Ï§ëÎ≥µ ÏÑ†ÌÉù Î∞©ÏßÄ
            if (!editNewVideos.find(v => v.id === videoId)) {
                editNewVideos.push(videoData);
                updateEditNewVideos();
                
                // Í≤ÄÏÉâ Í≤∞Í≥º Ïà®Í∏∞Í∏∞
                document.getElementById('editVideoResults').innerHTML = '';
                document.getElementById('editVideoSearch').value = '';
            }
        }

        // ÏàòÏ†ïÏö© ÏÉà ÎèôÏòÅÏÉÅ ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
        function updateEditNewVideos() {
            const container = document.getElementById('editNewVideos');
            
            if (editNewVideos.length === 0) {
                container.innerHTML = '';
                return;
            }
            
            container.innerHTML = editNewVideos.map(video => `
                <div class="video-item">
                    <img src="${video.thumbnail}" alt="${video.title}">
                    <div class="video-item-info">
                        <div class="video-item-title">${video.title}</div>
                        <div class="video-item-channel">${video.channel}</div>
                    </div>
                    <button class="remove-btn" onclick="removeEditNewVideo('${video.id}')">√ó</button>
                </div>
            `).join('');
        }

        // ÏàòÏ†ïÏö© ÏÉà ÎèôÏòÅÏÉÅ Ï†úÍ±∞
        function removeEditNewVideo(videoId) {
            editNewVideos = editNewVideos.filter(video => video.id !== videoId);
            updateEditNewVideos();
        }

        // ÏàòÏ†ïÎêú Í≤åÏãúÎ¨º Ï†ÄÏû•
        async function saveEditedPost() {
            console.log('editingPostId:', editingPostId);
            console.log('posts:', posts.map(p => p.id));
            alert('saveEditedPost called, editingPostId=' + editingPostId);
            const content = document.getElementById('editPostContent').value.trim();
            const selectedAccountId = document.getElementById('editPostAccount').value;
            if (!content) {
                alert('Í≤åÏãúÎ¨º ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            if (!selectedAccountId) {
                alert('ÏÇ¨Ïö©Ìï† Í≥ÑÏ†ïÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            const selectedAccount = accounts.find(acc => acc.id === selectedAccountId);
            if (!selectedAccount) {
                alert('ÏÑ†ÌÉùÎêú Í≥ÑÏ†ïÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');
                return;
            }
            const post = posts.find(p => p.id === editingPostId);
            if (!post) {
                alert('ÏàòÏ†ïÌï† Í≤åÏãúÎ¨ºÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');
                return;
            }
            // ÏÉÅÌÉú Ï≤¥ÌÅ¨ Ï∂îÍ∞Ä
            if (post.status === 'completed' || post.status === 'processing') {
                alert('ÏôÑÎ£åÎêòÏóàÍ±∞ÎÇò Ï≤òÎ¶¨Ï§ëÏù∏ Í≤åÏãúÎ¨ºÏùÄ ÏàòÏ†ïÌï† Ïàò ÏóÜÏäµÎãàÎã§.');
                closeEditPostModal();
                return;
            }
            // Í∏∞Ï°¥+ÏÉà Ïù¥ÎØ∏ÏßÄ/ÎèôÏòÅÏÉÅ Ìï©ÏπòÍ∏∞
            let images = (post.images || []).concat(editNewImages);
            let videos = (post.videos || []).concat(editNewVideos);
            // ÏÑúÎ≤ÑÏóê PUT ÏöîÏ≤≠
            const res = await fetch(`/api/posts/${editingPostId}`, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    content,
                    accountId: selectedAccountId,
                    images,
                    videos
                })
            });
            const result = await res.json();
            if (result.success) {
                alert('Í≤åÏãúÎ¨ºÏù¥ ÏàòÏ†ïÎêòÏóàÏäµÎãàÎã§.');
                await loadAllAndUpdatePosts();
                closeEditPostModal();
            } else {
                alert('Í≤åÏãúÎ¨º ÏàòÏ†ï Ïã§Ìå®');
            }
        }

        // ÏÑ§Ï†ï Ï†ÄÏû•
        function saveSettings() {
            const settings = {
                showBrowser: document.getElementById('showBrowser').checked,
                maximizeWindow: document.getElementById('maximizeWindow').checked,
                browserSpeed: document.getElementById('browserSpeed').value,
                postDelay: parseInt(document.getElementById('postDelay').value),
                manualPostWait: parseInt(document.getElementById('manualPostWait').value),
                autoRetry: document.getElementById('autoRetry').checked,
                skipOnError: document.getElementById('skipOnError').checked,
                closeOnComplete: document.getElementById('closeOnComplete').checked,
                detailedLogs: document.getElementById('detailedLogs').checked,
                saveLogsToFile: document.getElementById('saveLogsToFile').checked
            };
            // localStorage.setItem('automation_settings', JSON.stringify(settings)); // ÏÇ≠Ï†ú
            showStatus('success', 'ÏÑ§Ï†ïÏù¥ Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.');
        }

        // ÏûêÎèôÌôî ÏãúÏûë
        function startAutomation() {
            if (posts.length === 0) {
                alert('Î®ºÏ†Ä Í≤åÏãúÎ¨ºÏùÑ Ï∂îÍ∞ÄÌï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            // Ï≤òÎ¶¨Ìï† Í≤åÏãúÎ¨º ÌïÑÌÑ∞ÎßÅ (ÏôÑÎ£åÎêòÏßÄ ÏïäÏùÄ Í≤åÏãúÎ¨ºÎßå)
            const pendingPosts = posts.filter(post => post.status !== 'completed');
            if (pendingPosts.length === 0) {
                alert('Ï≤òÎ¶¨Ìï† Í≤åÏãúÎ¨ºÏù¥ ÏóÜÏäµÎãàÎã§.\nÎ™®Îì† Í≤åÏãúÎ¨ºÏù¥ Ïù¥ÎØ∏ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§.');
                return;
            }
            // Í∞Å postÏóê accountÎ•º ÎèôÏ†ÅÏúºÎ°ú Îß§Ìïë
            pendingPosts.forEach(post => {
                post.account = accounts.find(acc => acc.id === post.accountId) || null;
            });
            // Í≥ÑÏ†ïÏù¥ ÏÑ§Ï†ïÎêòÏßÄ ÏïäÏùÄ Í≤åÏãúÎ¨ºÏù¥ ÏûàÎäîÏßÄ ÌôïÏù∏ (ÏôÑÎ£åÎêòÏßÄ ÏïäÏùÄ Í≤åÏãúÎ¨º Ï§ëÏóêÏÑú)
            const postsWithoutAccount = pendingPosts.filter(post => !post.account);
            if (postsWithoutAccount.length > 0) {
                alert(`${postsWithoutAccount.length}Í∞úÏùò Í≤åÏãúÎ¨ºÏóê Í≥ÑÏ†ïÏù¥ ÏÑ§Ï†ïÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.\nÍ≥ÑÏ†ï Í¥ÄÎ¶¨ ÌÉ≠ÏóêÏÑú Í≥ÑÏ†ïÏùÑ Ï∂îÍ∞ÄÌïòÍ≥† Í≤åÏãúÎ¨ºÏóê Í≥ÑÏ†ïÏùÑ ÏÑ§Ï†ïÌï¥Ï£ºÏÑ∏Ïöî.`);
                switchTab('accounts');
                return;
            }
            
            // Ï≤òÎ¶¨Ìï† Í≤åÏãúÎ¨º Í∞úÏàò ÏïåÎ¶º
            const completedCount = posts.filter(post => post.status === 'completed').length;
            if (completedCount > 0) {
                addLog(`üìã Ï¥ù ${posts.length}Í∞ú Í≤åÏãúÎ¨º Ï§ë ${completedCount}Í∞úÎäî Ïù¥ÎØ∏ ÏôÑÎ£åÎêòÏñ¥ Í±¥ÎÑàÎúÅÎãàÎã§.`);
                addLog(`üéØ ${pendingPosts.length}Í∞ú Í≤åÏãúÎ¨ºÏùÑ Ï≤òÎ¶¨Ìï©ÎãàÎã§.`);
            }
            
            isAutomationRunning = true;
            currentPostIndex = 0;
            
            document.getElementById('startAutomation').disabled = true;
            document.getElementById('stopAutomation').disabled = false;
            
            showStatus('info', 'ÏûêÎèôÌôîÎ•º ÏãúÏûëÌï©ÎãàÎã§...');
            addLog('üöÄ ÏûêÎèôÌôî ÏãúÏûë');
            
            processNextPost();
        }

        // Îã§Ïùå Í≤åÏãúÎ¨º Ï≤òÎ¶¨
        function processNextPost() {
            if (!isAutomationRunning) {
                completeAutomation();
                return;
            }
            
            // ÏôÑÎ£åÎêòÏßÄ ÏïäÏùÄ Îã§Ïùå Í≤åÏãúÎ¨º Ï∞æÍ∏∞
            while (currentPostIndex < posts.length) {
                const post = posts[currentPostIndex];
                
                // Ïù¥ÎØ∏ ÏôÑÎ£åÎêú Í≤åÏãúÎ¨ºÏùÄ Í±¥ÎÑàÎõ∞Í∏∞
                if (post.status === 'completed') {
                    addLog(`‚úÖ Í≤åÏãúÎ¨º ${currentPostIndex + 1}ÏùÄ Ïù¥ÎØ∏ ÏôÑÎ£åÎêòÏñ¥ Í±¥ÎÑàÎúÅÎãàÎã§.`);
                    currentPostIndex++;
                    continue;
                }
                
                // Ï≤òÎ¶¨Ìï† Í≤åÏãúÎ¨º Î∞úÍ≤¨
                post.status = 'processing';
                updatePostList();
                break;
            }
            
            // Î™®Îì† Í≤åÏãúÎ¨º Ï≤òÎ¶¨ ÏôÑÎ£å
            if (currentPostIndex >= posts.length) {
                completeAutomation();
                return;
            }
            
            const post = posts[currentPostIndex];
            
            // Ïã§Ï†ú Ï≤òÎ¶¨Ìï† Í≤åÏãúÎ¨º Í∞úÏàò Í∏∞Ï§ÄÏúºÎ°ú ÏßÑÌñâÎ•† Í≥ÑÏÇ∞
            const totalPendingPosts = posts.filter(p => p.status !== 'completed').length;
            const processedPosts = posts.slice(0, currentPostIndex + 1).filter(p => p.status === 'processing' || p.status === 'completed').length;
            const progress = (processedPosts / Math.max(totalPendingPosts, 1)) * 100;
            
            updateProgress(progress, `Í≤åÏãúÎ¨º ${currentPostIndex + 1}/${posts.length} Ï≤òÎ¶¨ Ï§ë... (Ï≤òÎ¶¨ ÎåÄÏÉÅ: ${totalPendingPosts}Í∞ú)`);
            
            addLog(`üìù Í≤åÏãúÎ¨º ${currentPostIndex + 1} Ï≤òÎ¶¨ ÏãúÏûë`);
            
            // Ïã§Ï†ú ÏûêÎèôÌôî Ïã§Ìñâ (üì∏üé¨ ÎØ∏ÎîîÏñ¥ Ìè¨Ìï®)
            const settings = JSON.parse(localStorage.getItem('automation_settings') || '{}');
            const imageCount = post.images ? post.images.length : 0;
            const videoCount = post.videos ? post.videos.length : 0;
            
            addLog(`üì∏ Ïù¥ÎØ∏ÏßÄ ${imageCount}Í∞ú, üé¨ ÎèôÏòÅÏÉÅ ${videoCount}Í∞ú Ìè¨Ìï®`);
            addLog(`üöÄ Ïã§Ï†ú ÏûêÎèôÌôî ÏãúÏûë - Python Ïä§ÌÅ¨Î¶ΩÌä∏ Ïã§Ìñâ Ï§ë...`);
            
            // Ïã§Ï†ú ÏûêÎèôÌôî API Ìò∏Ï∂ú (Îã®Ïùº Í≤åÏãúÎ¨º API ÏÇ¨Ïö©)
            const automationData = {
                username: post.account ? post.account.username : localStorage.getItem('youtube_username'),
                password: post.account ? post.account.password : localStorage.getItem('youtube_password'),
                postContent: post.content,
                images: post.images || [],
                videos: post.videos || [],
                settings: settings,
                postIndex: currentPostIndex,
                // Í≥ÑÏ†ï Ï†ïÎ≥¥ Ï∂îÍ∞Ä (Îã§Ï§ë Í≥ÑÏ†ï ÏßÄÏõê)
                accountUsername: post.accountUsername || '',
                accountPassword: post.accountPassword || ''
            };

            // üîß Îç∞Ïù¥ÌÑ∞ Ï†ïÎ¶¨ Ìï®Ïàò - ÏßÅÎ†¨Ìôî Î∂àÍ∞ÄÎä•Ìïú Í∞ùÏ≤¥Î•º ÏïàÏ†ÑÌïú ÌòïÌÉúÎ°ú Î≥ÄÌôò
            function sanitizeAutomationData(data) {
                const result = { ...data };
                
                // Ïù¥ÎØ∏ÏßÄ Îç∞Ïù¥ÌÑ∞ Ï†ïÎ¶¨
                if (result.images && Array.isArray(result.images)) {
                    result.images = result.images.map((img, idx) => {
                        console.log(`üîß Ïù¥ÎØ∏ÏßÄ ${idx} Ï†ïÎ¶¨ Ï§ë:`, typeof img, img?.constructor?.name);
                        
                        if (img instanceof File) {
                            console.warn(`‚ö†Ô∏è File Í∞ùÏ≤¥ Î∞úÍ≤¨ - Ï†úÍ±∞Îê®`);
                            return null;
                        } else if (img instanceof Blob) {
                            console.warn(`‚ö†Ô∏è Blob Í∞ùÏ≤¥ Î∞úÍ≤¨ - Ï†úÍ±∞Îê®`);
                            return null;
                        } else if (img && typeof img === 'object') {
                            // ÏùºÎ∞ò Í∞ùÏ≤¥Ïù∏ Í≤ΩÏö∞ data ÏÜçÏÑ±Îßå Ïú†ÏßÄ
                            const cleaned = {};
                            Object.keys(img).forEach(key => {
                                const value = img[key];
                                if (typeof value === 'string' || typeof value === 'number' || typeof value === 'boolean') {
                                    cleaned[key] = value;
                                } else if (value instanceof File || value instanceof Blob) {
                                    console.warn(`‚ö†Ô∏è ${key}Ïóê File/Blob Í∞ùÏ≤¥ Î∞úÍ≤¨ - Ï†úÍ±∞Îê®`);
                                } else {
                                    try {
                                        JSON.stringify(value);
                                        cleaned[key] = value;
                                    } catch (e) {
                                        console.warn(`‚ö†Ô∏è ${key} ÏßÅÎ†¨Ìôî Î∂àÍ∞ÄÎä• - Ï†úÍ±∞Îê®`);
                                    }
                                }
                            });
                            return cleaned;
                        }
                        return img;
                    }).filter(img => img !== null);
                }
                
                // ÎèôÏòÅÏÉÅ Îç∞Ïù¥ÌÑ∞ Ï†ïÎ¶¨
                if (result.videos && Array.isArray(result.videos)) {
                    result.videos = result.videos.map(vid => {
                        if (vid instanceof File || vid instanceof Blob) {
                            console.warn(`‚ö†Ô∏è ÎèôÏòÅÏÉÅÏóê File/Blob Í∞ùÏ≤¥ Î∞úÍ≤¨ - Ï†úÍ±∞Îê®`);
                            return null;
                        }
                        return vid;
                    }).filter(vid => vid !== null);
                }
                
                // ÏµúÏ¢Ö ÏßÅÎ†¨Ìôî ÌÖåÏä§Ìä∏
                try {
                    JSON.stringify(result);
                    console.log('‚úÖ Îç∞Ïù¥ÌÑ∞ Ï†ïÎ¶¨ ÏôÑÎ£å - ÏßÅÎ†¨Ìôî Í∞ÄÎä•');
                } catch (e) {
                    console.error('‚ùå Îç∞Ïù¥ÌÑ∞ Ï†ïÎ¶¨ ÌõÑÏóêÎèÑ ÏßÅÎ†¨Ìôî Î∂àÍ∞ÄÎä•:', e);
                }
                
                return result;
            }

            // üîç ÎîîÎ≤ÑÍπÖ: Îç∞Ïù¥ÌÑ∞ ÌÉÄÏûÖ Î∞è ÏßÅÎ†¨Ìôî Í≤ÄÏÇ¨
            console.log('üöÄ ÏûêÎèôÌôî Îç∞Ïù¥ÌÑ∞ Ï†ÑÏÜ° - ÎîîÎ≤ÑÍπÖ ÏãúÏûë');
            console.log('üìä Îç∞Ïù¥ÌÑ∞ ÌÉÄÏûÖ Í≤ÄÏÇ¨:');
            console.log('- username type:', typeof automationData.username, 'value:', automationData.username);
            console.log('- password type:', typeof automationData.password, 'length:', automationData.password?.length);
            console.log('- postContent type:', typeof automationData.postContent, 'length:', automationData.postContent?.length);
            console.log('- images type:', typeof automationData.images, 'length:', automationData.images?.length);
            console.log('- videos type:', typeof automationData.videos, 'length:', automationData.videos?.length);
            console.log('- settings type:', typeof automationData.settings, 'value:', automationData.settings);
            console.log('- postIndex type:', typeof automationData.postIndex, 'value:', automationData.postIndex);
            
            // Ïù¥ÎØ∏ÏßÄ Îç∞Ïù¥ÌÑ∞ ÏÉÅÏÑ∏ Í≤ÄÏÇ¨
            if (automationData.images && automationData.images.length > 0) {
                console.log('üì∏ Ïù¥ÎØ∏ÏßÄ Îç∞Ïù¥ÌÑ∞ ÏÉÅÏÑ∏:');
                automationData.images.forEach((img, idx) => {
                    console.log(`  Ïù¥ÎØ∏ÏßÄ ${idx}:`, {
                        type: typeof img,
                        hasData: img && 'data' in img,
                        dataType: img?.data ? typeof img.data : 'none',
                        dataLength: img?.data ? img.data.length : 0,
                        keys: img ? Object.keys(img) : [],
                        isFile: img instanceof File,
                        isBlob: img instanceof Blob
                    });
                });
            }
            
            // ÎèôÏòÅÏÉÅ Îç∞Ïù¥ÌÑ∞ ÏÉÅÏÑ∏ Í≤ÄÏÇ¨
            if (automationData.videos && automationData.videos.length > 0) {
                console.log('üé¨ ÎèôÏòÅÏÉÅ Îç∞Ïù¥ÌÑ∞ ÏÉÅÏÑ∏:');
                automationData.videos.forEach((vid, idx) => {
                    console.log(`  ÎèôÏòÅÏÉÅ ${idx}:`, {
                        type: typeof vid,
                        hasUrl: vid && 'url' in vid,
                        urlType: vid?.url ? typeof vid.url : 'none',
                        keys: vid ? Object.keys(vid) : [],
                        isFile: vid instanceof File,
                        isBlob: vid instanceof Blob
                    });
                });
            }
            
            // JSON ÏßÅÎ†¨Ìôî ÌÖåÏä§Ìä∏
            try {
                const testSerialization = JSON.stringify(automationData);
                console.log('‚úÖ JSON ÏßÅÎ†¨Ìôî ÏÑ±Í≥µ, ÌÅ¨Í∏∞:', testSerialization.length);
            } catch (serError) {
                console.error('‚ùå JSON ÏßÅÎ†¨Ìôî Ïã§Ìå®:', serError);
                console.log('üîç ÏßÅÎ†¨Ìôî Ïã§Ìå® ÏõêÏù∏ Î∂ÑÏÑù...');
                
                // Í∞Å ÏÜçÏÑ±Î≥ÑÎ°ú ÏßÅÎ†¨Ìôî ÌÖåÏä§Ìä∏
                Object.keys(automationData).forEach(key => {
                    try {
                        JSON.stringify(automationData[key]);
                        console.log(`‚úÖ ${key}: ÏßÅÎ†¨Ìôî Í∞ÄÎä•`);
                    } catch (err) {
                        console.error(`‚ùå ${key}: ÏßÅÎ†¨Ìôî Î∂àÍ∞ÄÎä•`, err);
                    }
                });
            }
            
            // ElectronÏùò ipcRendererÎ•º ÌÜµÌï¥ Î©îÏù∏ ÌîÑÎ°úÏÑ∏Ïä§Ïóê ÏöîÏ≤≠
            let automationPromise;
            
            // Ìï≠ÏÉÅ fetchÎ°ú ÏÑúÎ≤Ñ API Ìò∏Ï∂ú (Ïõπ/Electron ÌÜµÏùº)
            automationPromise = fetch('/api/automate', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(automationData)
            }).then(response => response.json());
            
            automationPromise
            .then(async (data) => {
                if (data.success) {
                    post.status = 'completed';
                    await patchPostStatus(post.id, 'completed');
                    addLog(`‚úÖ Í≤åÏãúÎ¨º ${currentPostIndex + 1} ÏôÑÎ£å`);
                } else {
                    post.status = 'failed';
                    await patchPostStatus(post.id, 'failed');
                    addLog(`‚ùå Í≤åÏãúÎ¨º ${currentPostIndex + 1} Ïã§Ìå®: ${data.error}`);
                }
                
                // üíæ ÏÉÅÌÉú Î≥ÄÍ≤Ω ÌõÑ ÏûêÎèô Ï†ÄÏû•
                savePosts();
                updatePostList();
                currentPostIndex++;
                
                // Îã§Ïùå Í≤åÏãúÎ¨ºÎ°ú Ïù¥Îèô (ÎîúÎ†àÏù¥ ÌõÑ)
                const delay = parseInt(document.getElementById('postDelay').value) * 1000;
                setTimeout(() => {
                    if (isAutomationRunning) {
                        processNextPost();
                    }
                }, delay);
            })
            .catch(error => {
                console.error('üîç [FRONTEND] ÏûêÎèôÌôî Ïò§Î•ò ÏÉÅÏÑ∏:', error);
                console.error('üîç [FRONTEND] Ïò§Î•ò ÌÉÄÏûÖ:', typeof error);
                console.error('üîç [FRONTEND] Ïò§Î•ò Ïù¥Î¶Ñ:', error.name);
                console.error('üîç [FRONTEND] Ïò§Î•ò Î©îÏãúÏßÄ:', error.message);
                console.error('üîç [FRONTEND] Ïò§Î•ò Ïä§ÌÉù:', error.stack);
                
                // ÌÅ¥Î°† Ïò§Î•ò ÌäπÎ≥Ñ Ï≤òÎ¶¨
                if (error.message && error.message.includes('cloned')) {
                    console.error('üîç [FRONTEND] ÌÅ¥Î°† Ïò§Î•ò Í∞êÏßÄ!');
                    console.error('üîç [FRONTEND] ÌòÑÏû¨ Í≤åÏãúÎ¨º Îç∞Ïù¥ÌÑ∞:', post);
                    
                    // Ïù¥ÎØ∏ÏßÄ Îç∞Ïù¥ÌÑ∞ ÏÉÅÏÑ∏ Î∂ÑÏÑù
                    if (post.images && post.images.length > 0) {
                        console.error('üîç [FRONTEND] Ïù¥ÎØ∏ÏßÄ Îç∞Ïù¥ÌÑ∞ ÏÉÅÏÑ∏ Î∂ÑÏÑù:');
                        post.images.forEach((img, idx) => {
                            console.error(`  Ïù¥ÎØ∏ÏßÄ ${idx}:`, {
                                type: typeof img,
                                isFile: img instanceof File,
                                isBlob: img instanceof Blob,
                                isArrayBuffer: img instanceof ArrayBuffer,
                                constructor: img?.constructor?.name,
                                keys: Object.keys(img || {}),
                                hasData: img && 'data' in img,
                                dataType: img?.data ? typeof img.data : 'none',
                                dataLength: img?.data ? img.data.length : 0,
                                dataStartsWith: img?.data ? img.data.substring(0, 50) : 'none'
                            });
                            
                            // Í∞Å ÏÜçÏÑ±Î≥Ñ ÏßÅÎ†¨Ìôî ÌÖåÏä§Ìä∏
                            if (img && typeof img === 'object') {
                                Object.keys(img).forEach(key => {
                                    try {
                                        JSON.stringify(img[key]);
                                        console.error(`    ‚úÖ ${key}: ÏßÅÎ†¨Ìôî Í∞ÄÎä•`);
                                    } catch (serErr) {
                                        console.error(`    ‚ùå ${key}: ÏßÅÎ†¨Ìôî Î∂àÍ∞ÄÎä•`, serErr.message);
                                    }
                                });
                            }
                        });
                    }
                    
                    // ÎèôÏòÅÏÉÅ Îç∞Ïù¥ÌÑ∞ÎèÑ ÌôïÏù∏
                    if (post.videos && post.videos.length > 0) {
                        console.error('üîç [FRONTEND] ÎèôÏòÅÏÉÅ Îç∞Ïù¥ÌÑ∞ ÏÉÅÏÑ∏ Î∂ÑÏÑù:');
                        post.videos.forEach((vid, idx) => {
                            console.error(`  ÎèôÏòÅÏÉÅ ${idx}:`, {
                                type: typeof vid,
                                isFile: vid instanceof File,
                                isBlob: vid instanceof Blob,
                                constructor: vid?.constructor?.name,
                                keys: Object.keys(vid || {})
                            });
                        });
                    }
                    
                    // settings Í∞ùÏ≤¥ÎèÑ ÌôïÏù∏
                    console.error('üîç [FRONTEND] settings Í∞ùÏ≤¥ Î∂ÑÏÑù:', {
                        type: typeof settings,
                        keys: Object.keys(settings || {}),
                        values: settings
                    });
                }
                
                post.status = 'failed';
                addLog(`‚ùå Í≤åÏãúÎ¨º ${currentPostIndex + 1} Ïò§Î•ò: ${error.message}`);
                
                // üíæ ÏÉÅÌÉú Î≥ÄÍ≤Ω ÌõÑ ÏûêÎèô Ï†ÄÏû•
                savePosts();
                updatePostList();
                
                currentPostIndex++;
                setTimeout(() => {
                    if (isAutomationRunning) {
                        processNextPost();
                    }
                }, 2000);
            });
        }

        // ÏûêÎèôÌôî ÏôÑÎ£å
        function completeAutomation() {
            isAutomationRunning = false;
            
            document.getElementById('startAutomation').disabled = false;
            document.getElementById('stopAutomation').disabled = true;
            
            const completedCount = posts.filter(p => p.status === 'completed').length;
            const failedCount = posts.filter(p => p.status === 'failed').length;
            
            updateProgress(100, `ÏôÑÎ£å: ${completedCount}Í∞ú, Ïã§Ìå®: ${failedCount}Í∞ú`);
            showStatus('success', `ÏûêÎèôÌôî ÏôÑÎ£å! ÏÑ±Í≥µ: ${completedCount}Í∞ú, Ïã§Ìå®: ${failedCount}Í∞ú`);
            addLog(`üéâ ÏûêÎèôÌôî ÏôÑÎ£å - ÏÑ±Í≥µ: ${completedCount}Í∞ú, Ïã§Ìå®: ${failedCount}Í∞ú`);
        }

        // ÏûêÎèôÌôî Ï§ëÏßÄ
        function stopAutomation() {
            isAutomationRunning = false;
            
            document.getElementById('startAutomation').disabled = false;
            document.getElementById('stopAutomation').disabled = true;
            
            showStatus('info', 'ÏûêÎèôÌôîÍ∞Ä Ï§ëÏßÄÎêòÏóàÏäµÎãàÎã§.');
            addLog('‚èπÔ∏è ÏûêÎèôÌôî Ï§ëÏßÄÎê®');
        }

        // Ï¥àÍ∏∞Ìôî (üíæ ÏÉÅÌÉú Ï†ÄÏû• Ìè¨Ìï®)
        function resetAutomation() {
            const completedCount = posts.filter(post => post.status === 'completed').length;
            
            if (completedCount > 0) {
                const resetAll = confirm(
                    `ÏôÑÎ£åÎêú Í≤åÏãúÎ¨ºÏù¥ ${completedCount}Í∞ú ÏûàÏäµÎãàÎã§.\n\n` +
                    `"ÌôïÏù∏": Î™®Îì† Í≤åÏãúÎ¨ºÏùÑ ÎåÄÍ∏∞ ÏÉÅÌÉúÎ°ú Ï¥àÍ∏∞Ìôî\n` +
                    `"Ï∑®ÏÜå": ÏôÑÎ£åÎêú Í≤åÏãúÎ¨ºÏùÄ Ïú†ÏßÄÌïòÍ≥† Ïã§Ìå®/Ï≤òÎ¶¨Ï§ëÏù∏ Í≤åÏãúÎ¨ºÎßå Ï¥àÍ∏∞Ìôî`
                );
                
                if (resetAll) {
                    // Î™®Îì† Í≤åÏãúÎ¨ºÏùÑ ÎåÄÍ∏∞ ÏÉÅÌÉúÎ°ú Ï¥àÍ∏∞Ìôî
                    posts.forEach(post => post.status = 'pending');
                    addLog('üîÑ Î™®Îì† Í≤åÏãúÎ¨ºÏù¥ ÎåÄÍ∏∞ ÏÉÅÌÉúÎ°ú Ï¥àÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§.');
                } else {
                    // ÏôÑÎ£åÎêú Í≤åÏãúÎ¨ºÏùÄ Ïú†ÏßÄÌïòÍ≥† ÎÇòÎ®∏ÏßÄÎßå Ï¥àÍ∏∞Ìôî
                    posts.forEach(post => {
                        if (post.status !== 'completed') {
                            post.status = 'pending';
                        }
                    });
                    addLog(`üîÑ ÏôÑÎ£åÎêú ${completedCount}Í∞ú Í≤åÏãúÎ¨ºÏùÄ Ïú†ÏßÄÌïòÍ≥† ÎÇòÎ®∏ÏßÄÎßå Ï¥àÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§.`);
                }
            } else {
                // ÏôÑÎ£åÎêú Í≤åÏãúÎ¨ºÏù¥ ÏóÜÏúºÎ©¥ Î™®Îì† Í≤åÏãúÎ¨º Ï¥àÍ∏∞Ìôî
                posts.forEach(post => post.status = 'pending');
                addLog('üîÑ Î™®Îì† Í≤åÏãúÎ¨ºÏù¥ ÎåÄÍ∏∞ ÏÉÅÌÉúÎ°ú Ï¥àÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§.');
            }
            
            currentPostIndex = 0;
            
            // üíæ ÏÉÅÌÉú Ï¥àÍ∏∞Ìôî ÌõÑ Ï†ÄÏû•
            savePosts();
            
            updatePostList();
            updateProgress(0, 'ÏûêÎèôÌôî Ï§ÄÎπÑ ÏôÑÎ£å');
            clearLogs();
            showStatus('info', 'ÏûêÎèôÌôîÍ∞Ä Ï¥àÍ∏∞ÌôîÎêòÍ≥† Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§! üíæ');
        }

        // ÏßÑÌñâÎ•† ÏóÖÎç∞Ïù¥Ìä∏
        function updateProgress(percentage, text) {
            document.getElementById('progressFill').style.width = percentage + '%';
            document.getElementById('statusText').textContent = text;
        }

        // Î°úÍ∑∏ Ï∂îÍ∞Ä
        function addLog(message) {
            const logEntries = document.getElementById('logEntries');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = 'log-entry';
            logEntry.textContent = `[${timestamp}] ${message}`;
            logEntries.appendChild(logEntry);
            
            // Ïä§ÌÅ¨Î°§ÏùÑ Îß® ÏïÑÎûòÎ°ú
            logEntries.scrollTop = logEntries.scrollHeight;
        }

        // Î°úÍ∑∏ Ï¥àÍ∏∞Ìôî
        function clearLogs() {
            document.getElementById('logEntries').innerHTML = '<div class="log-entry">ÏûêÎèôÌôî ÏãúÏûëÏùÑ Í∏∞Îã§Î¶¨Îäî Ï§ë...</div>';
        }

        // üíæ Í≤åÏãúÎ¨º Ï†ÄÏû• Ìï®Ïàò
        function savePosts() {
            try {
                // localStorage.setItem('youtube_posts', JSON.stringify(posts)); // ÏÇ≠Ï†ú
                console.log('Í≤åÏãúÎ¨º Ï†ÄÏû• ÏôÑÎ£å:', posts.length + 'Í∞ú');
            } catch (error) {
                console.error('Í≤åÏãúÎ¨º Ï†ÄÏû• Ïã§Ìå®:', error);
                alert('Í≤åÏãúÎ¨º Ï†ÄÏû•Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§. Î∏åÎùºÏö∞Ï†Ä Ï†ÄÏû• Í≥µÍ∞ÑÏùÑ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.');
            }
        }

        // üíæ Í≤åÏãúÎ¨º Î∂àÎü¨Ïò§Í∏∞ Ìï®Ïàò (API Ïó∞Îèô)
        async function loadPosts() {
            try {
                const res = await fetch('/api/posts');
                if (!res.ok) throw new Error('Í≤åÏãúÎ¨º Î™©Î°ù Î∂àÎü¨Ïò§Í∏∞ Ïã§Ìå®');
                posts = await res.json();
                updatePostList();
                if (posts.length > 0) {
                    showStatus('info', `Ï†ÄÏû•Îêú Í≤åÏãúÎ¨º ${posts.length}Í∞úÎ•º Î∂àÎü¨ÏôîÏäµÎãàÎã§! üíæ`);
                }
            } catch (error) {
                console.error('Í≤åÏãúÎ¨º Î∂àÎü¨Ïò§Í∏∞ Ïã§Ìå®:', error);
                if (error instanceof TypeError && error.message.includes('Failed to fetch')) {
                    alert('Í≤åÏãúÎ¨º Î∂àÎü¨Ïò§Í∏∞ Ïã§Ìå®: Ïï±ÏùÑ Î∞òÎìúÏãú Electron(ÏïÑÏù¥ÏΩò ÎçîÎ∏îÌÅ¥Î¶≠ ÎòêÎäî npm run electron)ÏúºÎ°ú Ïã§ÌñâÌïòÏÑ∏Ïöî. Î∏åÎùºÏö∞Ï†ÄÏóêÏÑú ÏßÅÏ†ë Ïó¥Î©¥ ÎèôÏûëÌïòÏßÄ ÏïäÏäµÎãàÎã§.');
                }
                posts = [];
            }
        }

        // ========================================
        // üë• Í≥ÑÏ†ï Í¥ÄÎ¶¨ Ìï®ÏàòÎì§
        // ========================================

        // üíæ Í≥ÑÏ†ï Ï†ÄÏû• Ìï®Ïàò
        function saveAccounts() {
            try {
                localStorage.setItem('youtube_accounts', JSON.stringify(accounts));
                console.log('Í≥ÑÏ†ï Ï†ÄÏû• ÏôÑÎ£å:', accounts.length + 'Í∞ú');
                updateAccountCount();
            } catch (error) {
                console.error('Í≥ÑÏ†ï Ï†ÄÏû• Ïã§Ìå®:', error);
                alert('Í≥ÑÏ†ï Ï†ÄÏû•Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§. Î∏åÎùºÏö∞Ï†Ä Ï†ÄÏû• Í≥µÍ∞ÑÏùÑ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.');
            }
        }

        // üíæ Í≥ÑÏ†ï Î∂àÎü¨Ïò§Í∏∞ Ìï®Ïàò
        async function loadAccounts() {
            try {
                const res = await fetch('/api/accounts');
                if (!res.ok) throw new Error('Í≥ÑÏ†ï Î™©Î°ù Î∂àÎü¨Ïò§Í∏∞ Ïã§Ìå®');
                accounts = await res.json();
                updateAccountList();
                updateAccountDropdown();
                updateAccountCount();
            } catch (error) {
                console.error('Í≥ÑÏ†ï Î∂àÎü¨Ïò§Í∏∞ Ïã§Ìå®:', error);
                if (error instanceof TypeError && error.message.includes('Failed to fetch')) {
                    alert('Í≥ÑÏ†ï Î∂àÎü¨Ïò§Í∏∞ Ïã§Ìå®: Ïï±ÏùÑ Î∞òÎìúÏãú Electron(ÏïÑÏù¥ÏΩò ÎçîÎ∏îÌÅ¥Î¶≠ ÎòêÎäî npm run electron)ÏúºÎ°ú Ïã§ÌñâÌïòÏÑ∏Ïöî. Î∏åÎùºÏö∞Ï†ÄÏóêÏÑú ÏßÅÏ†ë Ïó¥Î©¥ ÎèôÏûëÌïòÏßÄ ÏïäÏäµÎãàÎã§.');
                }
                accounts = [];
            }
        }

        // Í≥ÑÏ†ï Ï∂îÍ∞Ä (API Ïó∞Îèô)
        async function addAccount() {
            const name = document.getElementById('accountName').value.trim();
            const username = document.getElementById('accountUsername').value.trim();
            const password = document.getElementById('accountPassword').value.trim();
            const description = document.getElementById('accountDescription').value.trim();
            if (!name || !username || !password) {
                alert('Í≥ÑÏ†ïÎ™Ö, ÏïÑÏù¥Îîî, ÎπÑÎ∞ÄÎ≤àÌò∏Îäî ÌïÑÏàò ÏûÖÎ†• Ìï≠Î™©ÏûÖÎãàÎã§.');
                return;
            }
            const accountData = { name, username, password, description };
            const result = await addAccountAPI(accountData);
            if (result.success) {
                alert('Í≥ÑÏ†ïÏù¥ Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§.');
                loadAccounts();
                clearAccountForm();
            } else {
                alert('Í≥ÑÏ†ï Ï∂îÍ∞Ä Ïã§Ìå®');
            }
        }

        // Í≥ÑÏ†ï ÏàòÏ†ï
        function editAccount(accountId) {
            const account = accounts.find(acc => acc.id === accountId);
            if (!account) return;

            editingAccountId = accountId;
            
            // ÌèºÏóê Í∏∞Ï°¥ Îç∞Ïù¥ÌÑ∞ ÏÑ§Ï†ï
            document.getElementById('accountName').value = account.name;
            document.getElementById('accountUsername').value = account.username;
            document.getElementById('accountPassword').value = account.password;
            document.getElementById('accountDescription').value = account.description;

            // UI Î≥ÄÍ≤Ω
            document.getElementById('cancelEditBtn').style.display = 'inline-block';
            document.querySelector('#accountForm button[onclick="addAccount()"]').textContent = 'üíæ Í≥ÑÏ†ï ÏàòÏ†ï';

            // Í≥ÑÏ†ï Í¥ÄÎ¶¨ ÌÉ≠ÏúºÎ°ú Ïù¥Îèô
            switchTab('accounts');
            
            // ÌèºÏúºÎ°ú Ïä§ÌÅ¨Î°§
            document.getElementById('accountForm').scrollIntoView({ behavior: 'smooth' });
        }

        // Í≥ÑÏ†ï ÏÇ≠Ï†ú (API Ïó∞Îèô)
        async function deleteAccount(accountId) {
            if (!confirm('Ï†ïÎßêÎ°ú ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) return;
            const res = await fetch(`/api/accounts/${accountId}`, { method: 'DELETE' });
            const result = await res.json();
            if (result.success) {
                alert('Í≥ÑÏ†ïÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.');
                loadAccounts();
            } else {
                alert('Í≥ÑÏ†ï ÏÇ≠Ï†ú Ïã§Ìå®');
            }
        }

        // Í≥ÑÏ†ï Ìèº Ï¥àÍ∏∞Ìôî
        function clearAccountForm() {
            document.getElementById('accountForm').reset();
            editingAccountId = null;
            document.getElementById('cancelEditBtn').style.display = 'none';
            document.querySelector('#accountForm button[onclick="addAccount()"]').textContent = '‚ûï Í≥ÑÏ†ï Ï∂îÍ∞Ä';
        }

        // Í≥ÑÏ†ï Î™©Î°ù ÏóÖÎç∞Ïù¥Ìä∏
        function updateAccountList() {
            const accountList = document.getElementById('accountList');
            
            if (accounts.length === 0) {
                accountList.innerHTML = `
                    <p style="text-align: center; color: #666; font-style: italic;">
                        ÏïÑÏßÅ Îì±Î°ùÎêú Í≥ÑÏ†ïÏù¥ ÏóÜÏäµÎãàÎã§.<br>
                        ÏúÑÏóêÏÑú Í≥ÑÏ†ïÏùÑ Ï∂îÍ∞ÄÌï¥Î≥¥ÏÑ∏Ïöî!
                    </p>
                `;
                return;
            }

            accountList.innerHTML = accounts.map(account => `
                <div class="post-item">
                    <div class="post-content">
                        <h4>üë§ ${account.name}</h4>
                        <p><strong>ÏïÑÏù¥Îîî:</strong> ${account.username}</p>
                        <p><strong>ÎπÑÎ∞ÄÎ≤àÌò∏:</strong> ${'*'.repeat(account.password.length)}</p>
                        ${account.description ? `<p><strong>ÏÑ§Î™Ö:</strong> ${account.description}</p>` : ''}
                        <p style="font-size: 12px; color: #999;">
                            ÏÉùÏÑ±Ïùº: ${new Date(account.createdAt).toLocaleString('ko-KR')}
                        </p>
                    </div>
                    <div class="post-actions">
                        <button class="btn btn-secondary" onclick="editAccount('${account.id}')">
                            ‚úèÔ∏è ÏàòÏ†ï
                        </button>
                        <button class="btn btn-danger" onclick="deleteAccount('${account.id}')">
                            üóëÔ∏è ÏÇ≠Ï†ú
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Í≥ÑÏ†ï ÎìúÎ°≠Îã§Ïö¥ ÏóÖÎç∞Ïù¥Ìä∏
        function updateAccountDropdown() {
            const postAccount = document.getElementById('postAccount');
            // Í∏∞Ï°¥ ÏòµÏÖò Ï†úÍ±∞ (Ï≤´ Î≤àÏß∏ ÏòµÏÖò Ï†úÏô∏)
            while (postAccount.children.length > 1) {
                postAccount.removeChild(postAccount.lastChild);
            }
            // Í≥ÑÏ†ï ÏòµÏÖò Ï∂îÍ∞Ä
            accounts.forEach(account => {
                const option = document.createElement('option');
                option.value = account.id;
                option.textContent = `${account.name} (${account.username})`;
                postAccount.appendChild(option);
            });
            // updateEditAccountDropdown(); // Î¨¥Ìïú Ïû¨Í∑Ä Î∞©ÏßÄ ÏúÑÌï¥ Ï†úÍ±∞
        }

        // Í≥ÑÏ†ï Í∞úÏàò ÏóÖÎç∞Ïù¥Ìä∏
        function updateAccountCount() {
            const accountCount = document.getElementById('accountCount');
            if (accountCount) {
                accountCount.textContent = `üíæ Ï†ÄÏû•Îêú Í≥ÑÏ†ï: ${accounts.length}Í∞ú`;
            }
        }

        // üíæ Î™®Îì† Í≤åÏãúÎ¨º ÏÇ≠Ï†ú Ìï®Ïàò
        function clearAllPosts() {
            if (confirm('Î™®Îì† Í≤åÏãúÎ¨ºÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?\nÏù¥ ÏûëÏóÖÏùÄ ÎêòÎèåÎ¶¥ Ïàò ÏóÜÏäµÎãàÎã§.')) {
                posts = [];
                savePosts();
                updatePostList();
                showStatus('success', 'Î™®Îì† Í≤åÏãúÎ¨ºÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§! üíæ');
            }
        }

        // üíæ Í≤åÏãúÎ¨º ÎÇ¥Î≥¥ÎÇ¥Í∏∞ (Î∞±ÏóÖ)
        function exportPosts() {
            if (posts.length === 0) {
                alert('ÎÇ¥Î≥¥ÎÇº Í≤åÏãúÎ¨ºÏù¥ ÏóÜÏäµÎãàÎã§.');
                return;
            }
            
            const dataStr = JSON.stringify(posts, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `youtube_posts_${new Date().toISOString().slice(0, 10)}.json`;
            link.click();
            
            URL.revokeObjectURL(url);
            showStatus('success', 'Í≤åÏãúÎ¨ºÏù¥ ÌååÏùºÎ°ú ÎÇ¥Î≥¥ÎÇ¥Ï°åÏäµÎãàÎã§! üíæ');
        }

        // üíæ Í≤åÏãúÎ¨º Í∞ÄÏ†∏Ïò§Í∏∞ (Î≥µÏõê)
        function importPosts() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const importedPosts = JSON.parse(e.target.result);
                        
                        if (Array.isArray(importedPosts)) {
                            if (posts.length > 0) {
                                if (confirm('Í∏∞Ï°¥ Í≤åÏãúÎ¨ºÏù¥ ÏûàÏäµÎãàÎã§. ÎçÆÏñ¥Ïì∞ÏãúÍ≤†ÏäµÎãàÍπå?')) {
                                    posts = importedPosts;
                                } else {
                                    posts = posts.concat(importedPosts);
                                }
                            } else {
                                posts = importedPosts;
                            }
                            
                            savePosts();
                            updatePostList();
                            showStatus('success', `${importedPosts.length}Í∞ú Í≤åÏãúÎ¨ºÏùÑ Í∞ÄÏ†∏ÏôîÏäµÎãàÎã§! üíæ`);
                        } else {
                            alert('Ïò¨Î∞îÎ•∏ Í≤åÏãúÎ¨º ÌååÏùºÏù¥ ÏïÑÎãôÎãàÎã§.');
                        }
                    } catch (error) {
                        alert('ÌååÏùºÏùÑ ÏùΩÎäî Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
                        console.error('Import error:', error);
                    }
                };
                reader.readAsText(file);
            };
            input.click();
        }

        // ÏÉÅÌÉú Î©îÏãúÏßÄ ÌëúÏãú
        function showStatus(type, message) {
            const status = document.getElementById('automationStatus');
            status.className = `status ${type}`;
            status.style.display = 'block';
            
            setTimeout(() => {
                status.style.display = 'none';
            }, 5000);
        }

        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ï¥àÍ∏∞Ìôî (üíæ Ï†ÄÏû•Îêú Îç∞Ïù¥ÌÑ∞ Î∂àÎü¨Ïò§Í∏∞)
        document.addEventListener('DOMContentLoaded', function() {
            // Electron ÌôòÍ≤ΩÏù¥ ÏïÑÎãàÎ©¥ Í≤ΩÍ≥†
            if (typeof window.electronAPI === 'undefined') {
                alert('Ïù¥ Ïï±ÏùÄ Î∞òÎìúÏãú ElectronÏúºÎ°ú Ïã§ÌñâÌï¥Ïïº Ìï©ÎãàÎã§. Î∏åÎùºÏö∞Ï†ÄÏóêÏÑú ÏßÅÏ†ë Ïó¥Î©¥ ÎèôÏûëÌïòÏßÄ ÏïäÏäµÎãàÎã§.');
            }
            loadAccounts();
            loadPosts();
            
            // Ï†ÄÏû•Îêú ÏÑ§Ï†ï Î∂àÎü¨Ïò§Í∏∞
            const savedSettings = localStorage.getItem('automation_settings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                Object.keys(settings).forEach(key => {
                    const element = document.getElementById(key);
                    if (element) {
                        if (element.type === 'checkbox') {
                            element.checked = settings[key];
                        } else {
                            element.value = settings[key];
                        }
                    }
                });
            }
            
            updatePostList();
            
            // üîå Electron ÌôòÍ≤ΩÏóêÏÑú Ïã§ÏãúÍ∞Ñ Î°úÍ∑∏ ÏàòÏã† ÏÑ§Ï†ï
            if (typeof window.electronAPI !== 'undefined') {
                console.log('üì± Electron Ïï± ÌôòÍ≤Ω Í∞êÏßÄ');
                
                // Ïã§ÏãúÍ∞Ñ Î°úÍ∑∏ ÏàòÏã†
                window.electronAPI.onAutomationLog((logData) => {
                    const { postIndex, message, type } = logData;
                    
                    if (type === 'error') {
                        addLog(`‚ùå [Í≤åÏãúÎ¨º ${postIndex + 1}] ${message}`);
                    } else {
                        addLog(`üìù [Í≤åÏãúÎ¨º ${postIndex + 1}] ${message}`);
                    }
                });
            } else {
                console.log('üåê Î∏åÎùºÏö∞Ï†Ä ÌôòÍ≤Ω Í∞êÏßÄ');
            }
        });

        // Í≤åÏãúÎ¨º Ï∂îÍ∞Ä Î≤ÑÌäº ÏòàÏãú (Ìèº Ï†úÏ∂ú Îì±ÏóêÏÑú)
        document.addEventListener('DOMContentLoaded', function() {
            var addPostBtn = document.getElementById('addPostBtn');
            if (addPostBtn) {
                addPostBtn.onclick = async function() {
                    const content = document.getElementById('newPostContent').value.trim();
                    const accountId = document.getElementById('postAccount').value;
                    if (!content) {
                        alert('Í≤åÏãúÎ¨º ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî.');
                        return;
                    }
                    if (!accountId) {
                        alert('Í≥ÑÏ†ïÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî.');
                        return;
                    }
                    await addPost({ content, accountId });
                };
            }
            var accountForm = document.getElementById('accountForm');
            if (accountForm) {
                accountForm.onsubmit = async function(e) {
                    e.preventDefault();
                    if (editingAccountId) {
                        await updateAccount(editingAccountId);
                    } else {
                        await addAccount();
                    }
                };
            }
            var postForm = document.getElementById('postForm');
            if (postForm) {
                postForm.onsubmit = async function(e) {
                    e.preventDefault();
                    if (editingPostId) {
                        await updatePost(editingPostId);
                    } else {
                        const content = document.getElementById('newPostContent').value.trim();
                        const accountId = document.getElementById('postAccount').value;
                        await addPost({ content, accountId });
                    }
                };
            }
            var cancelEditBtn = document.getElementById('cancelEditBtn');
            if (cancelEditBtn) cancelEditBtn.onclick = clearAccountForm;
            // ... Í∏∞ÌÉÄ Î≤ÑÌäºÎèÑ Î™®Îëê if (btn) ... ÌòïÌÉúÎ°úÎßå Ïó∞Í≤∞
        });

        // Í≤åÏãúÎ¨º ÏàòÏ†ï (API Ïó∞Îèô) - Í≥ÑÏ†ï Ï†ïÎ≥¥ÎèÑ Î∞òÏòÅ
        async function updatePost(postId) {
            const content = document.getElementById('newPostContent').value.trim();
            const accountId = document.getElementById('postAccount').value;
            if (!content) {
                alert('Í≤åÏãúÎ¨º ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî.');
                return;
            }
            if (!accountId) {
                alert('Í≥ÑÏ†ïÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî.');
                return;
            }
            const res = await fetch(`/api/posts/${postId}`, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ content, accountId })
            });
            const result = await res.json();
            if (result.success) {
                alert('Í≤åÏãúÎ¨ºÏù¥ ÏàòÏ†ïÎêòÏóàÏäµÎãàÎã§.');
                await loadAllAndUpdatePosts();
                cancelEditPost();
            } else {
                alert('Í≤åÏãúÎ¨º ÏàòÏ†ï Ïã§Ìå®');
            }
        }

        // Í≤åÏãúÎ¨º Î¶¨Ïä§Ìä∏ Î†åÎçîÎßÅ Í∞úÏÑ† (Ïù¥ÎØ∏ÏßÄ url, Í≥ÑÏ†ïÎ™Ö, ÏÉùÏÑ±Ïùº, ÏÉÅÌÉú Îì± ÌëúÏãú)
        function updatePostList() {
            const postList = document.getElementById('postList');
            if (!Array.isArray(posts) || posts.length === 0) {
                postList.innerHTML = `<p style="text-align: center; color: #666; font-style: italic;">ÏïÑÏßÅ Îì±Î°ùÎêú Í≤åÏãúÎ¨ºÏù¥ ÏóÜÏäµÎãàÎã§.<br>ÏúÑÏóêÏÑú Í≤åÏãúÎ¨ºÏùÑ Ï∂îÍ∞ÄÌï¥Î≥¥ÏÑ∏Ïöî!</p>`;
                return;
            }
            if (!accounts || accounts.length === 0) {
                loadAccounts().then(updatePostList);
                return;
            }
            postList.innerHTML = posts.map((post, idx) => {
                const account = accounts.find(acc => acc.id === post.accountId);
                const accountInfo = account ? `${account.name} (${account.username})` : 'Í≥ÑÏ†ï Ï†ïÎ≥¥ ÏóÜÏùå';
                const createdAtText = post.createdAt ? new Date(post.createdAt).toLocaleString('ko-KR') : 'ÎÇ†Ïßú ÏóÜÏùå';
                let statusText = 'ÎåÄÍ∏∞Ï§ë';
                if (post.status === 'completed') statusText = 'ÏôÑÎ£å';
                else if (post.status === 'failed') statusText = 'Ïã§Ìå®';
                else if (post.status === 'processing') statusText = 'Ï≤òÎ¶¨Ï§ë';
                else if (post.status) statusText = post.status;
                // Ïù¥ÎØ∏ÏßÄ ÌëúÏãú (urlÎßå ÏÇ¨Ïö©)
                let imagesHtml = '';
                if (post.images && post.images.length > 0) {
                    imagesHtml = `<div style='margin-top:4px;'>` + post.images.map(img => `<img src='${img.url}' alt='Ïù¥ÎØ∏ÏßÄ' style='width:60px;height:40px;object-fit:cover;margin-right:4px;border-radius:4px;'>`).join('') + `</div>`;
                }
                return `
                    <div class="post-item">
                        <div class="post-content">
                            <h4>${post.content}</h4>
                            <p>Í≥ÑÏ†ï: ${accountInfo}</p>
                            <p>ÏÉÅÌÉú: ${statusText} | ÏÉùÏÑ±Ïùº: ${createdAtText}</p>
                            ${imagesHtml}
                        </div>
                        <div class="post-actions">
                            <button class="btn btn-secondary" onclick="editPost('${post.id}')">ÏàòÏ†ï</button>
                            <button class="btn btn-danger" onclick="deletePost('${post.id}')">ÏÇ≠Ï†ú</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Í≤åÏãúÎ¨º ÏàòÏ†ï Î™®Îìú ÏßÑÏûÖ
        function editPost(postId) {
            const post = posts.find(p => p.id === postId);
            if (!post) return;
            openEditPostModal(post);
        }

        // Í≤åÏãúÎ¨º ÏàòÏ†ï Ï∑®ÏÜå
        function cancelEditPost() {
            editingPostId = null;
            document.getElementById('postForm').reset();
            document.getElementById('addPostBtn').textContent = '‚ûï Í≤åÏãúÎ¨º Ï∂îÍ∞Ä';
            document.getElementById('cancelEditPostBtn').style.display = 'none';
        }

        document.getElementById('cancelEditPostBtn').onclick = cancelEditPost;

        document.getElementById('postForm').onsubmit = async function(e) {
            e.preventDefault();
            if (editingPostId) {
                await updatePost(editingPostId);
            } else {
                await addPost({ content: document.getElementById('newPostContent').value.trim() });
            }
        };

        // Í≤åÏãúÎ¨º ÌïÑÌÑ∞/Ï†ïÎ†¨/Í≤ÄÏÉâ Ìï®Ïàò (Ìï≠ÏÉÅ Ï†ïÏùò)
        function getFilteredSortedPosts() {
            if (!Array.isArray(posts)) return [];
            let filtered = posts.slice();
            if (typeof postFilter !== 'undefined') {
                if (postFilter.status) filtered = filtered.filter(p => p.status === postFilter.status);
                if (postFilter.dateStart) filtered = filtered.filter(p => p.createdAt && p.createdAt >= postFilter.dateStart);
                if (postFilter.dateEnd) filtered = filtered.filter(p => p.createdAt && p.createdAt <= postFilter.dateEnd + 'T23:59:59');
                if (postFilter.search) filtered = filtered.filter(p => p.content && p.content.includes(postFilter.search));
                filtered.sort((a, b) => {
                    if (postFilter.sort === 'desc') return (b.createdAt || '').localeCompare(a.createdAt || '');
                    else return (a.createdAt || '').localeCompare(b.createdAt || '');
                });
            }
            return filtered;
        }

        // Î™®Îì† JS Ï¥àÍ∏∞Ìôî ÏΩîÎìúÎäî DOMContentLoaded ÏïàÏóêÏÑú Ïã§Ìñâ
        // (ÏïÑÎûò ÏòàÏãúÏ≤òÎüº Í∏∞Ï°¥ Ï¥àÍ∏∞Ìôî ÏΩîÎìú Í∞êÏã∏Í∏∞)
        document.addEventListener('DOMContentLoaded', function() {
            // Î≤ÑÌäº id Ï°¥Ïû¨ ÏãúÏóêÎßå Ïù¥Î≤§Ìä∏ Ïó∞Í≤∞
            var addPostBtn = document.getElementById('addPostBtn');
            if (addPostBtn) {
                addPostBtn.onclick = async function() {
                    const content = document.getElementById('newPostContent').value.trim();
                    const accountId = document.getElementById('postAccount').value;
                    if (!content) {
                        alert('Í≤åÏãúÎ¨º ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî.');
                        return;
                    }
                    if (!accountId) {
                        alert('Í≥ÑÏ†ïÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî.');
                        return;
                    }
                    await addPost({ content, accountId });
                };
            }
            // ... ÎÇòÎ®∏ÏßÄ Ï¥àÍ∏∞Ìôî ÏΩîÎìú (Ïù¥Î≤§Ìä∏ Ïó∞Í≤∞ Îì±)
        });

        // editPost Ìï®ÏàòÎäî Î∞òÎìúÏãú Ï†ÑÏó≠Ïóê Ï†ïÏùòÎêòÏñ¥Ïïº Ìï®
        window.editPost = editPost;

        // ÏÑúÎ≤Ñ APIÎ°ú Í≥ÑÏ†ï Ï∂îÍ∞Ä Ìï®Ïàò (Î∞òÎìúÏãú Ï†ïÏùò)
        async function addAccountAPI(accountData) {
            try {
                const res = await fetch('/api/accounts', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(accountData)
                });
                return await res.json();
            } catch (error) {
                alert('Í≥ÑÏ†ï Ï∂îÍ∞Ä Ïã§Ìå®: Ïï±ÏùÑ Î∞òÎìúÏãú Electron(ÏïÑÏù¥ÏΩò ÎçîÎ∏îÌÅ¥Î¶≠ ÎòêÎäî npm run electron)ÏúºÎ°ú Ïã§ÌñâÌïòÏÑ∏Ïöî. Î∏åÎùºÏö∞Ï†ÄÏóêÏÑú ÏßÅÏ†ë Ïó¥Î©¥ ÎèôÏûëÌïòÏßÄ ÏïäÏäµÎãàÎã§.');
                return { success: false };
            }
        }

        // (ÏûÑÏãú) localStorageÏóê ÎÇ®ÏïÑÏûàÎäî Í≥ÑÏ†ï Îç∞Ïù¥ÌÑ∞ ÏôÑÏ†Ñ ÏÇ≠Ï†ú
        try { localStorage.removeItem('youtube_accounts'); } catch(e) {}

        // Í≤åÏãúÎ¨ºÎèÑ ÏÑúÎ≤Ñ APIÎ°úÎßå Î∂àÎü¨Ïò§Í∏∞ (localStorage ÏΩîÎìú ÏôÑÏ†Ñ Ï†úÍ±∞)
        async function loadPosts() {
            try {
                const res = await fetch('/api/posts');
                if (!res.ok) throw new Error('Í≤åÏãúÎ¨º Î™©Î°ù Î∂àÎü¨Ïò§Í∏∞ Ïã§Ìå®');
                posts = await res.json();
                updatePostList();
                if (posts.length > 0) {
                    showStatus('info', `Ï†ÄÏû•Îêú Í≤åÏãúÎ¨º ${posts.length}Í∞úÎ•º Î∂àÎü¨ÏôîÏäµÎãàÎã§! üíæ`);
                }
            } catch (error) {
                console.error('Í≤åÏãúÎ¨º Î∂àÎü¨Ïò§Í∏∞ Ïã§Ìå®:', error);
                posts = [];
            }
        }

        window.addAccount = addAccount;

        // Í≤åÏãúÎ¨º Î™©Î°ùÍ≥º Í≥ÑÏ†ï Î™©Î°ùÏùÑ Î™®Îëê Î∂àÎü¨Ïò® Îí§ Í≤åÏãúÎ¨º Î¶¨Ïä§Ìä∏Î•º Î†åÎçîÎßÅÌïòÎäî Ìï®Ïàò
        async function loadAllAndUpdatePosts() {
            await loadAccounts();
            await loadPosts();
            updatePostList();
        }

        // Í≤åÏãúÎ¨º ÏÉÅÌÉúÎßå PATCHÎ°ú ÏÑúÎ≤ÑÏóê Ï†ÄÏû•
        async function patchPostStatus(postId, status) {
            try {
                const res = await fetch(`/api/posts/${postId}/status`, {
                    method: 'PATCH',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ status })
                });
                return await res.json();
            } catch (error) {
                console.error('Í≤åÏãúÎ¨º ÏÉÅÌÉú PATCH Ïã§Ìå®:', error);
                return { success: false };
            }
        }
    </script>
</body>
</html> 